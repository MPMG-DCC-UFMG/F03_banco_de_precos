{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar _util = require(\"zrender/lib/core/util\");\n\nvar createHashMap = _util.createHashMap;\nvar isObject = _util.isObject;\nvar map = _util.map;\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @constructor\n * @param {Object} [opt]\n * @param {Object} [opt.categories=[]]\n * @param {Object} [opt.needCollect=false]\n * @param {Object} [opt.deduplication=false]\n */\n\nfunction OrdinalMeta(opt) {\n  /**\n   * @readOnly\n   * @type {Array.<string>}\n   */\n  this.categories = opt.categories || [];\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._needCollect = opt.needCollect;\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._deduplication = opt.deduplication;\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._map;\n}\n/**\n * @param {module:echarts/model/Model} axisModel\n * @return {module:echarts/data/OrdinalMeta}\n */\n\n\nOrdinalMeta.createByAxisModel = function (axisModel) {\n  var option = axisModel.option;\n  var data = option.data;\n  var categories = data && map(data, getName);\n  return new OrdinalMeta({\n    categories: categories,\n    needCollect: !categories,\n    // deduplication is default in axis.\n    deduplication: option.dedplication !== false\n  });\n};\n\nvar proto = OrdinalMeta.prototype;\n/**\n * @param {string} category\n * @return {number} ordinal\n */\n\nproto.getOrdinal = function (category) {\n  return getOrCreateMap(this).get(category);\n};\n/**\n * @param {*} category\n * @return {number} The ordinal. If not found, return NaN.\n */\n\n\nproto.parseAndCollect = function (category) {\n  var index;\n  var needCollect = this._needCollect; // The value of category dim can be the index of the given category set.\n  // This feature is only supported when !needCollect, because we should\n  // consider a common case: a value is 2017, which is a number but is\n  // expected to be tread as a category. This case usually happen in dataset,\n  // where it happent to be no need of the index feature.\n\n  if (typeof category !== 'string' && !needCollect) {\n    return category;\n  } // Optimize for the scenario:\n  // category is ['2012-01-01', '2012-01-02', ...], where the input\n  // data has been ensured not duplicate and is large data.\n  // Notice, if a dataset dimension provide categroies, usually echarts\n  // should remove duplication except user tell echarts dont do that\n  // (set axis.deduplication = false), because echarts do not know whether\n  // the values in the category dimension has duplication (consider the\n  // parallel-aqi example)\n\n\n  if (needCollect && !this._deduplication) {\n    index = this.categories.length;\n    this.categories[index] = category;\n    return index;\n  }\n\n  var map = getOrCreateMap(this);\n  index = map.get(category);\n\n  if (index == null) {\n    if (needCollect) {\n      index = this.categories.length;\n      this.categories[index] = category;\n      map.set(category, index);\n    } else {\n      index = NaN;\n    }\n  }\n\n  return index;\n}; // Consider big data, do not create map until needed.\n\n\nfunction getOrCreateMap(ordinalMeta) {\n  return ordinalMeta._map || (ordinalMeta._map = createHashMap(ordinalMeta.categories));\n}\n\nfunction getName(obj) {\n  if (isObject(obj) && obj.value != null) {\n    return obj.value;\n  } else {\n    return obj + '';\n  }\n}\n\nvar _default = OrdinalMeta;\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/echarts/lib/data/OrdinalMeta.js"],"names":["_util","require","createHashMap","isObject","map","OrdinalMeta","opt","categories","_needCollect","needCollect","_deduplication","deduplication","_map","createByAxisModel","axisModel","option","data","getName","dedplication","proto","prototype","getOrdinal","category","getOrCreateMap","get","parseAndCollect","index","length","set","NaN","ordinalMeta","obj","value","_default","module","exports"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _util = require(\"zrender/lib/core/util\");\n\nvar createHashMap = _util.createHashMap;\nvar isObject = _util.isObject;\nvar map = _util.map;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @constructor\n * @param {Object} [opt]\n * @param {Object} [opt.categories=[]]\n * @param {Object} [opt.needCollect=false]\n * @param {Object} [opt.deduplication=false]\n */\nfunction OrdinalMeta(opt) {\n  /**\n   * @readOnly\n   * @type {Array.<string>}\n   */\n  this.categories = opt.categories || [];\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._needCollect = opt.needCollect;\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._deduplication = opt.deduplication;\n  /**\n   * @private\n   * @type {boolean}\n   */\n\n  this._map;\n}\n/**\n * @param {module:echarts/model/Model} axisModel\n * @return {module:echarts/data/OrdinalMeta}\n */\n\n\nOrdinalMeta.createByAxisModel = function (axisModel) {\n  var option = axisModel.option;\n  var data = option.data;\n  var categories = data && map(data, getName);\n  return new OrdinalMeta({\n    categories: categories,\n    needCollect: !categories,\n    // deduplication is default in axis.\n    deduplication: option.dedplication !== false\n  });\n};\n\nvar proto = OrdinalMeta.prototype;\n/**\n * @param {string} category\n * @return {number} ordinal\n */\n\nproto.getOrdinal = function (category) {\n  return getOrCreateMap(this).get(category);\n};\n/**\n * @param {*} category\n * @return {number} The ordinal. If not found, return NaN.\n */\n\n\nproto.parseAndCollect = function (category) {\n  var index;\n  var needCollect = this._needCollect; // The value of category dim can be the index of the given category set.\n  // This feature is only supported when !needCollect, because we should\n  // consider a common case: a value is 2017, which is a number but is\n  // expected to be tread as a category. This case usually happen in dataset,\n  // where it happent to be no need of the index feature.\n\n  if (typeof category !== 'string' && !needCollect) {\n    return category;\n  } // Optimize for the scenario:\n  // category is ['2012-01-01', '2012-01-02', ...], where the input\n  // data has been ensured not duplicate and is large data.\n  // Notice, if a dataset dimension provide categroies, usually echarts\n  // should remove duplication except user tell echarts dont do that\n  // (set axis.deduplication = false), because echarts do not know whether\n  // the values in the category dimension has duplication (consider the\n  // parallel-aqi example)\n\n\n  if (needCollect && !this._deduplication) {\n    index = this.categories.length;\n    this.categories[index] = category;\n    return index;\n  }\n\n  var map = getOrCreateMap(this);\n  index = map.get(category);\n\n  if (index == null) {\n    if (needCollect) {\n      index = this.categories.length;\n      this.categories[index] = category;\n      map.set(category, index);\n    } else {\n      index = NaN;\n    }\n  }\n\n  return index;\n}; // Consider big data, do not create map until needed.\n\n\nfunction getOrCreateMap(ordinalMeta) {\n  return ordinalMeta._map || (ordinalMeta._map = createHashMap(ordinalMeta.categories));\n}\n\nfunction getName(obj) {\n  if (isObject(obj) && obj.value != null) {\n    return obj.value;\n  } else {\n    return obj + '';\n  }\n}\n\nvar _default = OrdinalMeta;\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}