{"ast":null,"code":"var eventUtil = require(\"./event\");\n/**\n * Only implements needed gestures for mobile.\n */\n\n\nvar GestureMgr = function GestureMgr() {\n  /**\n   * @private\n   * @type {Array.<Object>}\n   */\n  this._track = [];\n};\n\nGestureMgr.prototype = {\n  constructor: GestureMgr,\n  recognize: function recognize(event, target, root) {\n    this._doTrack(event, target, root);\n\n    return this._recognize(event);\n  },\n  clear: function clear() {\n    this._track.length = 0;\n    return this;\n  },\n  _doTrack: function _doTrack(event, target, root) {\n    var touches = event.touches;\n\n    if (!touches) {\n      return;\n    }\n\n    var trackItem = {\n      points: [],\n      touches: [],\n      target: target,\n      event: event\n    };\n\n    for (var i = 0, len = touches.length; i < len; i++) {\n      var touch = touches[i];\n      var pos = eventUtil.clientToLocal(root, touch, {});\n      trackItem.points.push([pos.zrX, pos.zrY]);\n      trackItem.touches.push(touch);\n    }\n\n    this._track.push(trackItem);\n  },\n  _recognize: function _recognize(event) {\n    for (var eventName in recognizers) {\n      if (recognizers.hasOwnProperty(eventName)) {\n        var gestureInfo = recognizers[eventName](this._track, event);\n\n        if (gestureInfo) {\n          return gestureInfo;\n        }\n      }\n    }\n  }\n};\n\nfunction dist(pointPair) {\n  var dx = pointPair[1][0] - pointPair[0][0];\n  var dy = pointPair[1][1] - pointPair[0][1];\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nfunction center(pointPair) {\n  return [(pointPair[0][0] + pointPair[1][0]) / 2, (pointPair[0][1] + pointPair[1][1]) / 2];\n}\n\nvar recognizers = {\n  pinch: function pinch(track, event) {\n    var trackLen = track.length;\n\n    if (!trackLen) {\n      return;\n    }\n\n    var pinchEnd = (track[trackLen - 1] || {}).points;\n    var pinchPre = (track[trackLen - 2] || {}).points || pinchEnd;\n\n    if (pinchPre && pinchPre.length > 1 && pinchEnd && pinchEnd.length > 1) {\n      var pinchScale = dist(pinchEnd) / dist(pinchPre);\n      !isFinite(pinchScale) && (pinchScale = 1);\n      event.pinchScale = pinchScale;\n      var pinchCenter = center(pinchEnd);\n      event.pinchX = pinchCenter[0];\n      event.pinchY = pinchCenter[1];\n      return {\n        type: 'pinch',\n        target: track[0].target,\n        event: event\n      };\n    }\n  } // Only pinch currently.\n\n};\nvar _default = GestureMgr;\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/zrender/lib/core/GestureMgr.js"],"names":["eventUtil","require","GestureMgr","_track","prototype","constructor","recognize","event","target","root","_doTrack","_recognize","clear","length","touches","trackItem","points","i","len","touch","pos","clientToLocal","push","zrX","zrY","eventName","recognizers","hasOwnProperty","gestureInfo","dist","pointPair","dx","dy","Math","sqrt","center","pinch","track","trackLen","pinchEnd","pinchPre","pinchScale","isFinite","pinchCenter","pinchX","pinchY","type","_default","module","exports"],"mappings":"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","sourcesContent":["var eventUtil = require(\"./event\");\n\n/**\n * Only implements needed gestures for mobile.\n */\nvar GestureMgr = function () {\n  /**\n   * @private\n   * @type {Array.<Object>}\n   */\n  this._track = [];\n};\n\nGestureMgr.prototype = {\n  constructor: GestureMgr,\n  recognize: function (event, target, root) {\n    this._doTrack(event, target, root);\n\n    return this._recognize(event);\n  },\n  clear: function () {\n    this._track.length = 0;\n    return this;\n  },\n  _doTrack: function (event, target, root) {\n    var touches = event.touches;\n\n    if (!touches) {\n      return;\n    }\n\n    var trackItem = {\n      points: [],\n      touches: [],\n      target: target,\n      event: event\n    };\n\n    for (var i = 0, len = touches.length; i < len; i++) {\n      var touch = touches[i];\n      var pos = eventUtil.clientToLocal(root, touch, {});\n      trackItem.points.push([pos.zrX, pos.zrY]);\n      trackItem.touches.push(touch);\n    }\n\n    this._track.push(trackItem);\n  },\n  _recognize: function (event) {\n    for (var eventName in recognizers) {\n      if (recognizers.hasOwnProperty(eventName)) {\n        var gestureInfo = recognizers[eventName](this._track, event);\n\n        if (gestureInfo) {\n          return gestureInfo;\n        }\n      }\n    }\n  }\n};\n\nfunction dist(pointPair) {\n  var dx = pointPair[1][0] - pointPair[0][0];\n  var dy = pointPair[1][1] - pointPair[0][1];\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nfunction center(pointPair) {\n  return [(pointPair[0][0] + pointPair[1][0]) / 2, (pointPair[0][1] + pointPair[1][1]) / 2];\n}\n\nvar recognizers = {\n  pinch: function (track, event) {\n    var trackLen = track.length;\n\n    if (!trackLen) {\n      return;\n    }\n\n    var pinchEnd = (track[trackLen - 1] || {}).points;\n    var pinchPre = (track[trackLen - 2] || {}).points || pinchEnd;\n\n    if (pinchPre && pinchPre.length > 1 && pinchEnd && pinchEnd.length > 1) {\n      var pinchScale = dist(pinchEnd) / dist(pinchPre);\n      !isFinite(pinchScale) && (pinchScale = 1);\n      event.pinchScale = pinchScale;\n      var pinchCenter = center(pinchEnd);\n      event.pinchX = pinchCenter[0];\n      event.pinchY = pinchCenter[1];\n      return {\n        type: 'pinch',\n        target: track[0].target,\n        event: event\n      };\n    }\n  } // Only pinch currently.\n\n};\nvar _default = GestureMgr;\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}