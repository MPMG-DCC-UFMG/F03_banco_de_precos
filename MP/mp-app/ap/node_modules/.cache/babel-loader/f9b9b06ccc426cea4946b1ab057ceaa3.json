{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar env = require(\"zrender/lib/core/env\");\n\nvar visualDefault = require(\"../../visual/visualDefault\");\n\nvar VisualMapping = require(\"../../visual/VisualMapping\");\n\nvar visualSolution = require(\"../../visual/visualSolution\");\n\nvar modelUtil = require(\"../../util/model\");\n\nvar numberUtil = require(\"../../util/number\");\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\nvar mapVisual = VisualMapping.mapVisual;\nvar eachVisual = VisualMapping.eachVisual;\nvar isArray = zrUtil.isArray;\nvar each = zrUtil.each;\nvar asc = numberUtil.asc;\nvar linearMap = numberUtil.linearMap;\nvar noop = zrUtil.noop;\nvar VisualMapModel = echarts.extendComponentModel({\n  type: 'visualMap',\n  dependencies: ['series'],\n\n  /**\n   * @readOnly\n   * @type {Array.<string>}\n   */\n  stateList: ['inRange', 'outOfRange'],\n\n  /**\n   * @readOnly\n   * @type {Array.<string>}\n   */\n  replacableOptionKeys: ['inRange', 'outOfRange', 'target', 'controller', 'color'],\n\n  /**\n   * [lowerBound, upperBound]\n   *\n   * @readOnly\n   * @type {Array.<number>}\n   */\n  dataBound: [-Infinity, Infinity],\n\n  /**\n   * @readOnly\n   * @type {string|Object}\n   */\n  layoutMode: {\n    type: 'box',\n    ignoreSize: true\n  },\n\n  /**\n   * @protected\n   */\n  defaultOption: {\n    show: true,\n    zlevel: 0,\n    z: 4,\n    seriesIndex: 'all',\n    // 'all' or null/undefined: all series.\n    // A number or an array of number: the specified series.\n    // set min: 0, max: 200, only for campatible with ec2.\n    // In fact min max should not have default value.\n    min: 0,\n    // min value, must specified if pieces is not specified.\n    max: 200,\n    // max value, must specified if pieces is not specified.\n    dimension: null,\n    inRange: null,\n    // 'color', 'colorHue', 'colorSaturation', 'colorLightness', 'colorAlpha',\n    // 'symbol', 'symbolSize'\n    outOfRange: null,\n    // 'color', 'colorHue', 'colorSaturation',\n    // 'colorLightness', 'colorAlpha',\n    // 'symbol', 'symbolSize'\n    left: 0,\n    // 'center' ¦ 'left' ¦ 'right' ¦ {number} (px)\n    right: null,\n    // The same as left.\n    top: null,\n    // 'top' ¦ 'bottom' ¦ 'center' ¦ {number} (px)\n    bottom: 0,\n    // The same as top.\n    itemWidth: null,\n    itemHeight: null,\n    inverse: false,\n    orient: 'vertical',\n    // 'horizontal' ¦ 'vertical'\n    backgroundColor: 'rgba(0,0,0,0)',\n    borderColor: '#ccc',\n    // 值域边框颜色\n    contentColor: '#5793f3',\n    inactiveColor: '#aaa',\n    borderWidth: 0,\n    // 值域边框线宽，单位px，默认为0（无边框）\n    padding: 5,\n    // 值域内边距，单位px，默认各方向内边距为5，\n    // 接受数组分别设定上右下左边距，同css\n    textGap: 10,\n    //\n    precision: 0,\n    // 小数精度，默认为0，无小数点\n    color: null,\n    //颜色（deprecated，兼容ec2，顺序同pieces，不同于inRange/outOfRange）\n    formatter: null,\n    text: null,\n    // 文本，如['高', '低']，兼容ec2，text[0]对应高值，text[1]对应低值\n    textStyle: {\n      color: '#333' // 值域文字颜色\n\n    }\n  },\n\n  /**\n   * @protected\n   */\n  init: function init(option, parentModel, ecModel) {\n    /**\n     * @private\n     * @type {Array.<number>}\n     */\n    this._dataExtent;\n    /**\n     * @readOnly\n     */\n\n    this.targetVisuals = {};\n    /**\n     * @readOnly\n     */\n\n    this.controllerVisuals = {};\n    /**\n     * @readOnly\n     */\n\n    this.textStyleModel;\n    /**\n     * [width, height]\n     * @readOnly\n     * @type {Array.<number>}\n     */\n\n    this.itemSize;\n    this.mergeDefaultAndTheme(option, ecModel);\n  },\n\n  /**\n   * @protected\n   */\n  optionUpdated: function optionUpdated(newOption, isInit) {\n    var thisOption = this.option; // FIXME\n    // necessary?\n    // Disable realtime view update if canvas is not supported.\n\n    if (!env.canvasSupported) {\n      thisOption.realtime = false;\n    }\n\n    !isInit && visualSolution.replaceVisualOption(thisOption, newOption, this.replacableOptionKeys);\n    this.textStyleModel = this.getModel('textStyle');\n    this.resetItemSize();\n    this.completeVisualOption();\n  },\n\n  /**\n   * @protected\n   */\n  resetVisual: function resetVisual(supplementVisualOption) {\n    var stateList = this.stateList;\n    supplementVisualOption = zrUtil.bind(supplementVisualOption, this);\n    this.controllerVisuals = visualSolution.createVisualMappings(this.option.controller, stateList, supplementVisualOption);\n    this.targetVisuals = visualSolution.createVisualMappings(this.option.target, stateList, supplementVisualOption);\n  },\n\n  /**\n   * @protected\n   * @return {Array.<number>} An array of series indices.\n   */\n  getTargetSeriesIndices: function getTargetSeriesIndices() {\n    var optionSeriesIndex = this.option.seriesIndex;\n    var seriesIndices = [];\n\n    if (optionSeriesIndex == null || optionSeriesIndex === 'all') {\n      this.ecModel.eachSeries(function (seriesModel, index) {\n        seriesIndices.push(index);\n      });\n    } else {\n      seriesIndices = modelUtil.normalizeToArray(optionSeriesIndex);\n    }\n\n    return seriesIndices;\n  },\n\n  /**\n   * @public\n   */\n  eachTargetSeries: function eachTargetSeries(callback, context) {\n    zrUtil.each(this.getTargetSeriesIndices(), function (seriesIndex) {\n      callback.call(context, this.ecModel.getSeriesByIndex(seriesIndex));\n    }, this);\n  },\n\n  /**\n   * @pubilc\n   */\n  isTargetSeries: function isTargetSeries(seriesModel) {\n    var is = false;\n    this.eachTargetSeries(function (model) {\n      model === seriesModel && (is = true);\n    });\n    return is;\n  },\n\n  /**\n   * @example\n   * this.formatValueText(someVal); // format single numeric value to text.\n   * this.formatValueText(someVal, true); // format single category value to text.\n   * this.formatValueText([min, max]); // format numeric min-max to text.\n   * this.formatValueText([this.dataBound[0], max]); // using data lower bound.\n   * this.formatValueText([min, this.dataBound[1]]); // using data upper bound.\n   *\n   * @param {number|Array.<number>} value Real value, or this.dataBound[0 or 1].\n   * @param {boolean} [isCategory=false] Only available when value is number.\n   * @param {Array.<string>} edgeSymbols Open-close symbol when value is interval.\n   * @return {string}\n   * @protected\n   */\n  formatValueText: function formatValueText(value, isCategory, edgeSymbols) {\n    var option = this.option;\n    var precision = option.precision;\n    var dataBound = this.dataBound;\n    var formatter = option.formatter;\n    var isMinMax;\n    var textValue;\n    edgeSymbols = edgeSymbols || ['<', '>'];\n\n    if (zrUtil.isArray(value)) {\n      value = value.slice();\n      isMinMax = true;\n    }\n\n    textValue = isCategory ? value : isMinMax ? [toFixed(value[0]), toFixed(value[1])] : toFixed(value);\n\n    if (zrUtil.isString(formatter)) {\n      return formatter.replace('{value}', isMinMax ? textValue[0] : textValue).replace('{value2}', isMinMax ? textValue[1] : textValue);\n    } else if (zrUtil.isFunction(formatter)) {\n      return isMinMax ? formatter(value[0], value[1]) : formatter(value);\n    }\n\n    if (isMinMax) {\n      if (value[0] === dataBound[0]) {\n        return edgeSymbols[0] + ' ' + textValue[1];\n      } else if (value[1] === dataBound[1]) {\n        return edgeSymbols[1] + ' ' + textValue[0];\n      } else {\n        return textValue[0] + ' - ' + textValue[1];\n      }\n    } else {\n      // Format single value (includes category case).\n      return textValue;\n    }\n\n    function toFixed(val) {\n      return val === dataBound[0] ? 'min' : val === dataBound[1] ? 'max' : (+val).toFixed(Math.min(precision, 20));\n    }\n  },\n\n  /**\n   * @protected\n   */\n  resetExtent: function resetExtent() {\n    var thisOption = this.option; // Can not calculate data extent by data here.\n    // Because series and data may be modified in processing stage.\n    // So we do not support the feature \"auto min/max\".\n\n    var extent = asc([thisOption.min, thisOption.max]);\n    this._dataExtent = extent;\n  },\n\n  /**\n   * @public\n   * @param {module:echarts/data/List} list\n   * @return {string} Concrete dimention. If return null/undefined,\n   *                  no dimension used.\n   */\n  getDataDimension: function getDataDimension(list) {\n    var optDim = this.option.dimension;\n    var listDimensions = list.dimensions;\n\n    if (optDim == null && !listDimensions.length) {\n      return;\n    }\n\n    if (optDim != null) {\n      return list.getDimension(optDim);\n    }\n\n    var dimNames = list.dimensions;\n\n    for (var i = dimNames.length - 1; i >= 0; i--) {\n      var dimName = dimNames[i];\n      var dimInfo = list.getDimensionInfo(dimName);\n\n      if (!dimInfo.isCalculationCoord) {\n        return dimName;\n      }\n    }\n  },\n\n  /**\n   * @public\n   * @override\n   */\n  getExtent: function getExtent() {\n    return this._dataExtent.slice();\n  },\n\n  /**\n   * @protected\n   */\n  completeVisualOption: function completeVisualOption() {\n    var ecModel = this.ecModel;\n    var thisOption = this.option;\n    var base = {\n      inRange: thisOption.inRange,\n      outOfRange: thisOption.outOfRange\n    };\n    var target = thisOption.target || (thisOption.target = {});\n    var controller = thisOption.controller || (thisOption.controller = {});\n    zrUtil.merge(target, base); // Do not override\n\n    zrUtil.merge(controller, base); // Do not override\n\n    var isCategory = this.isCategory();\n    completeSingle.call(this, target);\n    completeSingle.call(this, controller);\n    completeInactive.call(this, target, 'inRange', 'outOfRange'); // completeInactive.call(this, target, 'outOfRange', 'inRange');\n\n    completeController.call(this, controller);\n\n    function completeSingle(base) {\n      // Compatible with ec2 dataRange.color.\n      // The mapping order of dataRange.color is: [high value, ..., low value]\n      // whereas inRange.color and outOfRange.color is [low value, ..., high value]\n      // Notice: ec2 has no inverse.\n      if (isArray(thisOption.color) // If there has been inRange: {symbol: ...}, adding color is a mistake.\n      // So adding color only when no inRange defined.\n      && !base.inRange) {\n        base.inRange = {\n          color: thisOption.color.slice().reverse()\n        };\n      } // Compatible with previous logic, always give a defautl color, otherwise\n      // simple config with no inRange and outOfRange will not work.\n      // Originally we use visualMap.color as the default color, but setOption at\n      // the second time the default color will be erased. So we change to use\n      // constant DEFAULT_COLOR.\n      // If user do not want the default color, set inRange: {color: null}.\n\n\n      base.inRange = base.inRange || {\n        color: ecModel.get('gradientColor')\n      }; // If using shortcut like: {inRange: 'symbol'}, complete default value.\n\n      each(this.stateList, function (state) {\n        var visualType = base[state];\n\n        if (zrUtil.isString(visualType)) {\n          var defa = visualDefault.get(visualType, 'active', isCategory);\n\n          if (defa) {\n            base[state] = {};\n            base[state][visualType] = defa;\n          } else {\n            // Mark as not specified.\n            delete base[state];\n          }\n        }\n      }, this);\n    }\n\n    function completeInactive(base, stateExist, stateAbsent) {\n      var optExist = base[stateExist];\n      var optAbsent = base[stateAbsent];\n\n      if (optExist && !optAbsent) {\n        optAbsent = base[stateAbsent] = {};\n        each(optExist, function (visualData, visualType) {\n          if (!VisualMapping.isValidType(visualType)) {\n            return;\n          }\n\n          var defa = visualDefault.get(visualType, 'inactive', isCategory);\n\n          if (defa != null) {\n            optAbsent[visualType] = defa; // Compatibable with ec2:\n            // Only inactive color to rgba(0,0,0,0) can not\n            // make label transparent, so use opacity also.\n\n            if (visualType === 'color' && !optAbsent.hasOwnProperty('opacity') && !optAbsent.hasOwnProperty('colorAlpha')) {\n              optAbsent.opacity = [0, 0];\n            }\n          }\n        });\n      }\n    }\n\n    function completeController(controller) {\n      var symbolExists = (controller.inRange || {}).symbol || (controller.outOfRange || {}).symbol;\n      var symbolSizeExists = (controller.inRange || {}).symbolSize || (controller.outOfRange || {}).symbolSize;\n      var inactiveColor = this.get('inactiveColor');\n      each(this.stateList, function (state) {\n        var itemSize = this.itemSize;\n        var visuals = controller[state]; // Set inactive color for controller if no other color\n        // attr (like colorAlpha) specified.\n\n        if (!visuals) {\n          visuals = controller[state] = {\n            color: isCategory ? inactiveColor : [inactiveColor]\n          };\n        } // Consistent symbol and symbolSize if not specified.\n\n\n        if (visuals.symbol == null) {\n          visuals.symbol = symbolExists && zrUtil.clone(symbolExists) || (isCategory ? 'roundRect' : ['roundRect']);\n        }\n\n        if (visuals.symbolSize == null) {\n          visuals.symbolSize = symbolSizeExists && zrUtil.clone(symbolSizeExists) || (isCategory ? itemSize[0] : [itemSize[0], itemSize[0]]);\n        } // Filter square and none.\n\n\n        visuals.symbol = mapVisual(visuals.symbol, function (symbol) {\n          return symbol === 'none' || symbol === 'square' ? 'roundRect' : symbol;\n        }); // Normalize symbolSize\n\n        var symbolSize = visuals.symbolSize;\n\n        if (symbolSize != null) {\n          var max = -Infinity; // symbolSize can be object when categories defined.\n\n          eachVisual(symbolSize, function (value) {\n            value > max && (max = value);\n          });\n          visuals.symbolSize = mapVisual(symbolSize, function (value) {\n            return linearMap(value, [0, max], [0, itemSize[0]], true);\n          });\n        }\n      }, this);\n    }\n  },\n\n  /**\n   * @protected\n   */\n  resetItemSize: function resetItemSize() {\n    this.itemSize = [parseFloat(this.get('itemWidth')), parseFloat(this.get('itemHeight'))];\n  },\n\n  /**\n   * @public\n   */\n  isCategory: function isCategory() {\n    return !!this.option.categories;\n  },\n\n  /**\n   * @public\n   * @abstract\n   */\n  setSelected: noop,\n\n  /**\n   * @public\n   * @abstract\n   * @param {*|module:echarts/data/List} valueOrData\n   * @param {number} dataIndex\n   * @return {string} state See this.stateList\n   */\n  getValueState: noop,\n\n  /**\n   * FIXME\n   * Do not publish to thirt-part-dev temporarily\n   * util the interface is stable. (Should it return\n   * a function but not visual meta?)\n   *\n   * @pubilc\n   * @abstract\n   * @param {Function} getColorVisual\n   *        params: value, valueState\n   *        return: color\n   * @return {Object} visualMeta\n   *        should includes {stops, outerColors}\n   *        outerColor means [colorBeyondMinValue, colorBeyondMaxValue]\n   */\n  getVisualMeta: noop\n});\nvar _default = VisualMapModel;\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/echarts/lib/component/visualMap/VisualMapModel.js"],"names":["echarts","require","zrUtil","env","visualDefault","VisualMapping","visualSolution","modelUtil","numberUtil","mapVisual","eachVisual","isArray","each","asc","linearMap","noop","VisualMapModel","extendComponentModel","type","dependencies","stateList","replacableOptionKeys","dataBound","Infinity","layoutMode","ignoreSize","defaultOption","show","zlevel","z","seriesIndex","min","max","dimension","inRange","outOfRange","left","right","top","bottom","itemWidth","itemHeight","inverse","orient","backgroundColor","borderColor","contentColor","inactiveColor","borderWidth","padding","textGap","precision","color","formatter","text","textStyle","init","option","parentModel","ecModel","_dataExtent","targetVisuals","controllerVisuals","textStyleModel","itemSize","mergeDefaultAndTheme","optionUpdated","newOption","isInit","thisOption","canvasSupported","realtime","replaceVisualOption","getModel","resetItemSize","completeVisualOption","resetVisual","supplementVisualOption","bind","createVisualMappings","controller","target","getTargetSeriesIndices","optionSeriesIndex","seriesIndices","eachSeries","seriesModel","index","push","normalizeToArray","eachTargetSeries","callback","context","call","getSeriesByIndex","isTargetSeries","is","model","formatValueText","value","isCategory","edgeSymbols","isMinMax","textValue","slice","toFixed","isString","replace","isFunction","val","Math","resetExtent","extent","getDataDimension","list","optDim","listDimensions","dimensions","length","getDimension","dimNames","i","dimName","dimInfo","getDimensionInfo","isCalculationCoord","getExtent","base","merge","completeSingle","completeInactive","completeController","reverse","get","state","visualType","defa","stateExist","stateAbsent","optExist","optAbsent","visualData","isValidType","hasOwnProperty","opacity","symbolExists","symbol","symbolSizeExists","symbolSize","visuals","clone","parseFloat","categories","setSelected","getValueState","getVisualMeta","_default","module","exports"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar env = require(\"zrender/lib/core/env\");\n\nvar visualDefault = require(\"../../visual/visualDefault\");\n\nvar VisualMapping = require(\"../../visual/VisualMapping\");\n\nvar visualSolution = require(\"../../visual/visualSolution\");\n\nvar modelUtil = require(\"../../util/model\");\n\nvar numberUtil = require(\"../../util/number\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar mapVisual = VisualMapping.mapVisual;\nvar eachVisual = VisualMapping.eachVisual;\nvar isArray = zrUtil.isArray;\nvar each = zrUtil.each;\nvar asc = numberUtil.asc;\nvar linearMap = numberUtil.linearMap;\nvar noop = zrUtil.noop;\nvar VisualMapModel = echarts.extendComponentModel({\n  type: 'visualMap',\n  dependencies: ['series'],\n\n  /**\n   * @readOnly\n   * @type {Array.<string>}\n   */\n  stateList: ['inRange', 'outOfRange'],\n\n  /**\n   * @readOnly\n   * @type {Array.<string>}\n   */\n  replacableOptionKeys: ['inRange', 'outOfRange', 'target', 'controller', 'color'],\n\n  /**\n   * [lowerBound, upperBound]\n   *\n   * @readOnly\n   * @type {Array.<number>}\n   */\n  dataBound: [-Infinity, Infinity],\n\n  /**\n   * @readOnly\n   * @type {string|Object}\n   */\n  layoutMode: {\n    type: 'box',\n    ignoreSize: true\n  },\n\n  /**\n   * @protected\n   */\n  defaultOption: {\n    show: true,\n    zlevel: 0,\n    z: 4,\n    seriesIndex: 'all',\n    // 'all' or null/undefined: all series.\n    // A number or an array of number: the specified series.\n    // set min: 0, max: 200, only for campatible with ec2.\n    // In fact min max should not have default value.\n    min: 0,\n    // min value, must specified if pieces is not specified.\n    max: 200,\n    // max value, must specified if pieces is not specified.\n    dimension: null,\n    inRange: null,\n    // 'color', 'colorHue', 'colorSaturation', 'colorLightness', 'colorAlpha',\n    // 'symbol', 'symbolSize'\n    outOfRange: null,\n    // 'color', 'colorHue', 'colorSaturation',\n    // 'colorLightness', 'colorAlpha',\n    // 'symbol', 'symbolSize'\n    left: 0,\n    // 'center' ¦ 'left' ¦ 'right' ¦ {number} (px)\n    right: null,\n    // The same as left.\n    top: null,\n    // 'top' ¦ 'bottom' ¦ 'center' ¦ {number} (px)\n    bottom: 0,\n    // The same as top.\n    itemWidth: null,\n    itemHeight: null,\n    inverse: false,\n    orient: 'vertical',\n    // 'horizontal' ¦ 'vertical'\n    backgroundColor: 'rgba(0,0,0,0)',\n    borderColor: '#ccc',\n    // 值域边框颜色\n    contentColor: '#5793f3',\n    inactiveColor: '#aaa',\n    borderWidth: 0,\n    // 值域边框线宽，单位px，默认为0（无边框）\n    padding: 5,\n    // 值域内边距，单位px，默认各方向内边距为5，\n    // 接受数组分别设定上右下左边距，同css\n    textGap: 10,\n    //\n    precision: 0,\n    // 小数精度，默认为0，无小数点\n    color: null,\n    //颜色（deprecated，兼容ec2，顺序同pieces，不同于inRange/outOfRange）\n    formatter: null,\n    text: null,\n    // 文本，如['高', '低']，兼容ec2，text[0]对应高值，text[1]对应低值\n    textStyle: {\n      color: '#333' // 值域文字颜色\n\n    }\n  },\n\n  /**\n   * @protected\n   */\n  init: function (option, parentModel, ecModel) {\n    /**\n     * @private\n     * @type {Array.<number>}\n     */\n    this._dataExtent;\n    /**\n     * @readOnly\n     */\n\n    this.targetVisuals = {};\n    /**\n     * @readOnly\n     */\n\n    this.controllerVisuals = {};\n    /**\n     * @readOnly\n     */\n\n    this.textStyleModel;\n    /**\n     * [width, height]\n     * @readOnly\n     * @type {Array.<number>}\n     */\n\n    this.itemSize;\n    this.mergeDefaultAndTheme(option, ecModel);\n  },\n\n  /**\n   * @protected\n   */\n  optionUpdated: function (newOption, isInit) {\n    var thisOption = this.option; // FIXME\n    // necessary?\n    // Disable realtime view update if canvas is not supported.\n\n    if (!env.canvasSupported) {\n      thisOption.realtime = false;\n    }\n\n    !isInit && visualSolution.replaceVisualOption(thisOption, newOption, this.replacableOptionKeys);\n    this.textStyleModel = this.getModel('textStyle');\n    this.resetItemSize();\n    this.completeVisualOption();\n  },\n\n  /**\n   * @protected\n   */\n  resetVisual: function (supplementVisualOption) {\n    var stateList = this.stateList;\n    supplementVisualOption = zrUtil.bind(supplementVisualOption, this);\n    this.controllerVisuals = visualSolution.createVisualMappings(this.option.controller, stateList, supplementVisualOption);\n    this.targetVisuals = visualSolution.createVisualMappings(this.option.target, stateList, supplementVisualOption);\n  },\n\n  /**\n   * @protected\n   * @return {Array.<number>} An array of series indices.\n   */\n  getTargetSeriesIndices: function () {\n    var optionSeriesIndex = this.option.seriesIndex;\n    var seriesIndices = [];\n\n    if (optionSeriesIndex == null || optionSeriesIndex === 'all') {\n      this.ecModel.eachSeries(function (seriesModel, index) {\n        seriesIndices.push(index);\n      });\n    } else {\n      seriesIndices = modelUtil.normalizeToArray(optionSeriesIndex);\n    }\n\n    return seriesIndices;\n  },\n\n  /**\n   * @public\n   */\n  eachTargetSeries: function (callback, context) {\n    zrUtil.each(this.getTargetSeriesIndices(), function (seriesIndex) {\n      callback.call(context, this.ecModel.getSeriesByIndex(seriesIndex));\n    }, this);\n  },\n\n  /**\n   * @pubilc\n   */\n  isTargetSeries: function (seriesModel) {\n    var is = false;\n    this.eachTargetSeries(function (model) {\n      model === seriesModel && (is = true);\n    });\n    return is;\n  },\n\n  /**\n   * @example\n   * this.formatValueText(someVal); // format single numeric value to text.\n   * this.formatValueText(someVal, true); // format single category value to text.\n   * this.formatValueText([min, max]); // format numeric min-max to text.\n   * this.formatValueText([this.dataBound[0], max]); // using data lower bound.\n   * this.formatValueText([min, this.dataBound[1]]); // using data upper bound.\n   *\n   * @param {number|Array.<number>} value Real value, or this.dataBound[0 or 1].\n   * @param {boolean} [isCategory=false] Only available when value is number.\n   * @param {Array.<string>} edgeSymbols Open-close symbol when value is interval.\n   * @return {string}\n   * @protected\n   */\n  formatValueText: function (value, isCategory, edgeSymbols) {\n    var option = this.option;\n    var precision = option.precision;\n    var dataBound = this.dataBound;\n    var formatter = option.formatter;\n    var isMinMax;\n    var textValue;\n    edgeSymbols = edgeSymbols || ['<', '>'];\n\n    if (zrUtil.isArray(value)) {\n      value = value.slice();\n      isMinMax = true;\n    }\n\n    textValue = isCategory ? value : isMinMax ? [toFixed(value[0]), toFixed(value[1])] : toFixed(value);\n\n    if (zrUtil.isString(formatter)) {\n      return formatter.replace('{value}', isMinMax ? textValue[0] : textValue).replace('{value2}', isMinMax ? textValue[1] : textValue);\n    } else if (zrUtil.isFunction(formatter)) {\n      return isMinMax ? formatter(value[0], value[1]) : formatter(value);\n    }\n\n    if (isMinMax) {\n      if (value[0] === dataBound[0]) {\n        return edgeSymbols[0] + ' ' + textValue[1];\n      } else if (value[1] === dataBound[1]) {\n        return edgeSymbols[1] + ' ' + textValue[0];\n      } else {\n        return textValue[0] + ' - ' + textValue[1];\n      }\n    } else {\n      // Format single value (includes category case).\n      return textValue;\n    }\n\n    function toFixed(val) {\n      return val === dataBound[0] ? 'min' : val === dataBound[1] ? 'max' : (+val).toFixed(Math.min(precision, 20));\n    }\n  },\n\n  /**\n   * @protected\n   */\n  resetExtent: function () {\n    var thisOption = this.option; // Can not calculate data extent by data here.\n    // Because series and data may be modified in processing stage.\n    // So we do not support the feature \"auto min/max\".\n\n    var extent = asc([thisOption.min, thisOption.max]);\n    this._dataExtent = extent;\n  },\n\n  /**\n   * @public\n   * @param {module:echarts/data/List} list\n   * @return {string} Concrete dimention. If return null/undefined,\n   *                  no dimension used.\n   */\n  getDataDimension: function (list) {\n    var optDim = this.option.dimension;\n    var listDimensions = list.dimensions;\n\n    if (optDim == null && !listDimensions.length) {\n      return;\n    }\n\n    if (optDim != null) {\n      return list.getDimension(optDim);\n    }\n\n    var dimNames = list.dimensions;\n\n    for (var i = dimNames.length - 1; i >= 0; i--) {\n      var dimName = dimNames[i];\n      var dimInfo = list.getDimensionInfo(dimName);\n\n      if (!dimInfo.isCalculationCoord) {\n        return dimName;\n      }\n    }\n  },\n\n  /**\n   * @public\n   * @override\n   */\n  getExtent: function () {\n    return this._dataExtent.slice();\n  },\n\n  /**\n   * @protected\n   */\n  completeVisualOption: function () {\n    var ecModel = this.ecModel;\n    var thisOption = this.option;\n    var base = {\n      inRange: thisOption.inRange,\n      outOfRange: thisOption.outOfRange\n    };\n    var target = thisOption.target || (thisOption.target = {});\n    var controller = thisOption.controller || (thisOption.controller = {});\n    zrUtil.merge(target, base); // Do not override\n\n    zrUtil.merge(controller, base); // Do not override\n\n    var isCategory = this.isCategory();\n    completeSingle.call(this, target);\n    completeSingle.call(this, controller);\n    completeInactive.call(this, target, 'inRange', 'outOfRange'); // completeInactive.call(this, target, 'outOfRange', 'inRange');\n\n    completeController.call(this, controller);\n\n    function completeSingle(base) {\n      // Compatible with ec2 dataRange.color.\n      // The mapping order of dataRange.color is: [high value, ..., low value]\n      // whereas inRange.color and outOfRange.color is [low value, ..., high value]\n      // Notice: ec2 has no inverse.\n      if (isArray(thisOption.color) // If there has been inRange: {symbol: ...}, adding color is a mistake.\n      // So adding color only when no inRange defined.\n      && !base.inRange) {\n        base.inRange = {\n          color: thisOption.color.slice().reverse()\n        };\n      } // Compatible with previous logic, always give a defautl color, otherwise\n      // simple config with no inRange and outOfRange will not work.\n      // Originally we use visualMap.color as the default color, but setOption at\n      // the second time the default color will be erased. So we change to use\n      // constant DEFAULT_COLOR.\n      // If user do not want the default color, set inRange: {color: null}.\n\n\n      base.inRange = base.inRange || {\n        color: ecModel.get('gradientColor')\n      }; // If using shortcut like: {inRange: 'symbol'}, complete default value.\n\n      each(this.stateList, function (state) {\n        var visualType = base[state];\n\n        if (zrUtil.isString(visualType)) {\n          var defa = visualDefault.get(visualType, 'active', isCategory);\n\n          if (defa) {\n            base[state] = {};\n            base[state][visualType] = defa;\n          } else {\n            // Mark as not specified.\n            delete base[state];\n          }\n        }\n      }, this);\n    }\n\n    function completeInactive(base, stateExist, stateAbsent) {\n      var optExist = base[stateExist];\n      var optAbsent = base[stateAbsent];\n\n      if (optExist && !optAbsent) {\n        optAbsent = base[stateAbsent] = {};\n        each(optExist, function (visualData, visualType) {\n          if (!VisualMapping.isValidType(visualType)) {\n            return;\n          }\n\n          var defa = visualDefault.get(visualType, 'inactive', isCategory);\n\n          if (defa != null) {\n            optAbsent[visualType] = defa; // Compatibable with ec2:\n            // Only inactive color to rgba(0,0,0,0) can not\n            // make label transparent, so use opacity also.\n\n            if (visualType === 'color' && !optAbsent.hasOwnProperty('opacity') && !optAbsent.hasOwnProperty('colorAlpha')) {\n              optAbsent.opacity = [0, 0];\n            }\n          }\n        });\n      }\n    }\n\n    function completeController(controller) {\n      var symbolExists = (controller.inRange || {}).symbol || (controller.outOfRange || {}).symbol;\n      var symbolSizeExists = (controller.inRange || {}).symbolSize || (controller.outOfRange || {}).symbolSize;\n      var inactiveColor = this.get('inactiveColor');\n      each(this.stateList, function (state) {\n        var itemSize = this.itemSize;\n        var visuals = controller[state]; // Set inactive color for controller if no other color\n        // attr (like colorAlpha) specified.\n\n        if (!visuals) {\n          visuals = controller[state] = {\n            color: isCategory ? inactiveColor : [inactiveColor]\n          };\n        } // Consistent symbol and symbolSize if not specified.\n\n\n        if (visuals.symbol == null) {\n          visuals.symbol = symbolExists && zrUtil.clone(symbolExists) || (isCategory ? 'roundRect' : ['roundRect']);\n        }\n\n        if (visuals.symbolSize == null) {\n          visuals.symbolSize = symbolSizeExists && zrUtil.clone(symbolSizeExists) || (isCategory ? itemSize[0] : [itemSize[0], itemSize[0]]);\n        } // Filter square and none.\n\n\n        visuals.symbol = mapVisual(visuals.symbol, function (symbol) {\n          return symbol === 'none' || symbol === 'square' ? 'roundRect' : symbol;\n        }); // Normalize symbolSize\n\n        var symbolSize = visuals.symbolSize;\n\n        if (symbolSize != null) {\n          var max = -Infinity; // symbolSize can be object when categories defined.\n\n          eachVisual(symbolSize, function (value) {\n            value > max && (max = value);\n          });\n          visuals.symbolSize = mapVisual(symbolSize, function (value) {\n            return linearMap(value, [0, max], [0, itemSize[0]], true);\n          });\n        }\n      }, this);\n    }\n  },\n\n  /**\n   * @protected\n   */\n  resetItemSize: function () {\n    this.itemSize = [parseFloat(this.get('itemWidth')), parseFloat(this.get('itemHeight'))];\n  },\n\n  /**\n   * @public\n   */\n  isCategory: function () {\n    return !!this.option.categories;\n  },\n\n  /**\n   * @public\n   * @abstract\n   */\n  setSelected: noop,\n\n  /**\n   * @public\n   * @abstract\n   * @param {*|module:echarts/data/List} valueOrData\n   * @param {number} dataIndex\n   * @return {string} state See this.stateList\n   */\n  getValueState: noop,\n\n  /**\n   * FIXME\n   * Do not publish to thirt-part-dev temporarily\n   * util the interface is stable. (Should it return\n   * a function but not visual meta?)\n   *\n   * @pubilc\n   * @abstract\n   * @param {Function} getColorVisual\n   *        params: value, valueState\n   *        return: color\n   * @return {Object} visualMeta\n   *        should includes {stops, outerColors}\n   *        outerColor means [colorBeyondMinValue, colorBeyondMaxValue]\n   */\n  getVisualMeta: noop\n});\nvar _default = VisualMapModel;\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}