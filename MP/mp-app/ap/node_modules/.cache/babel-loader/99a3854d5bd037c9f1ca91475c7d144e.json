{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar numberUtil = require(\"../util/number\");\n\nvar formatUtil = require(\"../util/format\");\n\nvar scaleHelper = require(\"./helper\");\n\nvar IntervalScale = require(\"./Interval\");\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/*\n* A third-party license is embeded for some of the code in this file:\n* The \"scaleLevels\" was originally copied from \"d3.js\" with some\n* modifications made for this project.\n* (See more details in the comment on the definition of \"scaleLevels\" below.)\n* The use of the source code of this file is also subject to the terms\n* and consitions of the license of \"d3.js\" (BSD-3Clause, see\n* </licenses/LICENSE-d3>).\n*/\n// [About UTC and local time zone]:\n// In most cases, `number.parseDate` will treat input data string as local time\n// (except time zone is specified in time string). And `format.formateTime` returns\n// local time by default. option.useUTC is false by default. This design have\n// concidered these common case:\n// (1) Time that is persistent in server is in UTC, but it is needed to be diplayed\n// in local time by default.\n// (2) By default, the input data string (e.g., '2011-01-02') should be displayed\n// as its original time, without any time difference.\n\n\nvar intervalScaleProto = IntervalScale.prototype;\nvar mathCeil = Math.ceil;\nvar mathFloor = Math.floor;\nvar ONE_SECOND = 1000;\nvar ONE_MINUTE = ONE_SECOND * 60;\nvar ONE_HOUR = ONE_MINUTE * 60;\nvar ONE_DAY = ONE_HOUR * 24; // FIXME 公用？\n\nvar bisect = function bisect(a, x, lo, hi) {\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n\n    if (a[mid][1] < x) {\n      lo = mid + 1;\n    } else {\n      hi = mid;\n    }\n  }\n\n  return lo;\n};\n/**\n * @alias module:echarts/coord/scale/Time\n * @constructor\n */\n\n\nvar TimeScale = IntervalScale.extend({\n  type: 'time',\n\n  /**\n   * @override\n   */\n  getLabel: function getLabel(val) {\n    var stepLvl = this._stepLvl;\n    var date = new Date(val);\n    return formatUtil.formatTime(stepLvl[0], date, this.getSetting('useUTC'));\n  },\n\n  /**\n   * @override\n   */\n  niceExtent: function niceExtent(opt) {\n    var extent = this._extent; // If extent start and end are same, expand them\n\n    if (extent[0] === extent[1]) {\n      // Expand extent\n      extent[0] -= ONE_DAY;\n      extent[1] += ONE_DAY;\n    } // If there are no data and extent are [Infinity, -Infinity]\n\n\n    if (extent[1] === -Infinity && extent[0] === Infinity) {\n      var d = new Date();\n      extent[1] = +new Date(d.getFullYear(), d.getMonth(), d.getDate());\n      extent[0] = extent[1] - ONE_DAY;\n    }\n\n    this.niceTicks(opt.splitNumber, opt.minInterval, opt.maxInterval); // var extent = this._extent;\n\n    var interval = this._interval;\n\n    if (!opt.fixMin) {\n      extent[0] = numberUtil.round(mathFloor(extent[0] / interval) * interval);\n    }\n\n    if (!opt.fixMax) {\n      extent[1] = numberUtil.round(mathCeil(extent[1] / interval) * interval);\n    }\n  },\n\n  /**\n   * @override\n   */\n  niceTicks: function niceTicks(approxTickNum, minInterval, maxInterval) {\n    approxTickNum = approxTickNum || 10;\n    var extent = this._extent;\n    var span = extent[1] - extent[0];\n    var approxInterval = span / approxTickNum;\n\n    if (minInterval != null && approxInterval < minInterval) {\n      approxInterval = minInterval;\n    }\n\n    if (maxInterval != null && approxInterval > maxInterval) {\n      approxInterval = maxInterval;\n    }\n\n    var scaleLevelsLen = scaleLevels.length;\n    var idx = bisect(scaleLevels, approxInterval, 0, scaleLevelsLen);\n    var level = scaleLevels[Math.min(idx, scaleLevelsLen - 1)];\n    var interval = level[1]; // Same with interval scale if span is much larger than 1 year\n\n    if (level[0] === 'year') {\n      var yearSpan = span / interval; // From \"Nice Numbers for Graph Labels\" of Graphic Gems\n      // var niceYearSpan = numberUtil.nice(yearSpan, false);\n\n      var yearStep = numberUtil.nice(yearSpan / approxTickNum, true);\n      interval *= yearStep;\n    }\n\n    var timezoneOffset = this.getSetting('useUTC') ? 0 : new Date(+extent[0] || +extent[1]).getTimezoneOffset() * 60 * 1000;\n    var niceExtent = [Math.round(mathCeil((extent[0] - timezoneOffset) / interval) * interval + timezoneOffset), Math.round(mathFloor((extent[1] - timezoneOffset) / interval) * interval + timezoneOffset)];\n    scaleHelper.fixExtent(niceExtent, extent);\n    this._stepLvl = level; // Interval will be used in getTicks\n\n    this._interval = interval;\n    this._niceExtent = niceExtent;\n  },\n  parse: function parse(val) {\n    // val might be float.\n    return +numberUtil.parseDate(val);\n  }\n});\nzrUtil.each(['contain', 'normalize'], function (methodName) {\n  TimeScale.prototype[methodName] = function (val) {\n    return intervalScaleProto[methodName].call(this, this.parse(val));\n  };\n});\n/**\n * This implementation was originally copied from \"d3.js\"\n * <https://github.com/d3/d3/blob/b516d77fb8566b576088e73410437494717ada26/src/time/scale.js>\n * with some modifications made for this program.\n * See the license statement at the head of this file.\n */\n\nvar scaleLevels = [// Format              interval\n['hh:mm:ss', ONE_SECOND], // 1s\n['hh:mm:ss', ONE_SECOND * 5], // 5s\n['hh:mm:ss', ONE_SECOND * 10], // 10s\n['hh:mm:ss', ONE_SECOND * 15], // 15s\n['hh:mm:ss', ONE_SECOND * 30], // 30s\n['hh:mm\\nMM-dd', ONE_MINUTE], // 1m\n['hh:mm\\nMM-dd', ONE_MINUTE * 5], // 5m\n['hh:mm\\nMM-dd', ONE_MINUTE * 10], // 10m\n['hh:mm\\nMM-dd', ONE_MINUTE * 15], // 15m\n['hh:mm\\nMM-dd', ONE_MINUTE * 30], // 30m\n['hh:mm\\nMM-dd', ONE_HOUR], // 1h\n['hh:mm\\nMM-dd', ONE_HOUR * 2], // 2h\n['hh:mm\\nMM-dd', ONE_HOUR * 6], // 6h\n['hh:mm\\nMM-dd', ONE_HOUR * 12], // 12h\n['MM-dd\\nyyyy', ONE_DAY], // 1d\n['MM-dd\\nyyyy', ONE_DAY * 2], // 2d\n['MM-dd\\nyyyy', ONE_DAY * 3], // 3d\n['MM-dd\\nyyyy', ONE_DAY * 4], // 4d\n['MM-dd\\nyyyy', ONE_DAY * 5], // 5d\n['MM-dd\\nyyyy', ONE_DAY * 6], // 6d\n['week', ONE_DAY * 7], // 7d\n['MM-dd\\nyyyy', ONE_DAY * 10], // 10d\n['week', ONE_DAY * 14], // 2w\n['week', ONE_DAY * 21], // 3w\n['month', ONE_DAY * 31], // 1M\n['week', ONE_DAY * 42], // 6w\n['month', ONE_DAY * 62], // 2M\n['week', ONE_DAY * 70], // 10w\n['quarter', ONE_DAY * 95], // 3M\n['month', ONE_DAY * 31 * 4], // 4M\n['month', ONE_DAY * 31 * 5], // 5M\n['half-year', ONE_DAY * 380 / 2], // 6M\n['month', ONE_DAY * 31 * 8], // 8M\n['month', ONE_DAY * 31 * 10], // 10M\n['year', ONE_DAY * 380] // 1Y\n];\n/**\n * @param {module:echarts/model/Model}\n * @return {module:echarts/scale/Time}\n */\n\nTimeScale.create = function (model) {\n  return new TimeScale({\n    useUTC: model.ecModel.get('useUTC')\n  });\n};\n\nvar _default = TimeScale;\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/echarts/lib/scale/Time.js"],"names":["zrUtil","require","numberUtil","formatUtil","scaleHelper","IntervalScale","intervalScaleProto","prototype","mathCeil","Math","ceil","mathFloor","floor","ONE_SECOND","ONE_MINUTE","ONE_HOUR","ONE_DAY","bisect","a","x","lo","hi","mid","TimeScale","extend","type","getLabel","val","stepLvl","_stepLvl","date","Date","formatTime","getSetting","niceExtent","opt","extent","_extent","Infinity","d","getFullYear","getMonth","getDate","niceTicks","splitNumber","minInterval","maxInterval","interval","_interval","fixMin","round","fixMax","approxTickNum","span","approxInterval","scaleLevelsLen","scaleLevels","length","idx","level","min","yearSpan","yearStep","nice","timezoneOffset","getTimezoneOffset","fixExtent","_niceExtent","parse","parseDate","each","methodName","call","create","model","useUTC","ecModel","get","_default","module","exports"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar numberUtil = require(\"../util/number\");\n\nvar formatUtil = require(\"../util/format\");\n\nvar scaleHelper = require(\"./helper\");\n\nvar IntervalScale = require(\"./Interval\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/*\n* A third-party license is embeded for some of the code in this file:\n* The \"scaleLevels\" was originally copied from \"d3.js\" with some\n* modifications made for this project.\n* (See more details in the comment on the definition of \"scaleLevels\" below.)\n* The use of the source code of this file is also subject to the terms\n* and consitions of the license of \"d3.js\" (BSD-3Clause, see\n* </licenses/LICENSE-d3>).\n*/\n// [About UTC and local time zone]:\n// In most cases, `number.parseDate` will treat input data string as local time\n// (except time zone is specified in time string). And `format.formateTime` returns\n// local time by default. option.useUTC is false by default. This design have\n// concidered these common case:\n// (1) Time that is persistent in server is in UTC, but it is needed to be diplayed\n// in local time by default.\n// (2) By default, the input data string (e.g., '2011-01-02') should be displayed\n// as its original time, without any time difference.\nvar intervalScaleProto = IntervalScale.prototype;\nvar mathCeil = Math.ceil;\nvar mathFloor = Math.floor;\nvar ONE_SECOND = 1000;\nvar ONE_MINUTE = ONE_SECOND * 60;\nvar ONE_HOUR = ONE_MINUTE * 60;\nvar ONE_DAY = ONE_HOUR * 24; // FIXME 公用？\n\nvar bisect = function (a, x, lo, hi) {\n  while (lo < hi) {\n    var mid = lo + hi >>> 1;\n\n    if (a[mid][1] < x) {\n      lo = mid + 1;\n    } else {\n      hi = mid;\n    }\n  }\n\n  return lo;\n};\n/**\n * @alias module:echarts/coord/scale/Time\n * @constructor\n */\n\n\nvar TimeScale = IntervalScale.extend({\n  type: 'time',\n\n  /**\n   * @override\n   */\n  getLabel: function (val) {\n    var stepLvl = this._stepLvl;\n    var date = new Date(val);\n    return formatUtil.formatTime(stepLvl[0], date, this.getSetting('useUTC'));\n  },\n\n  /**\n   * @override\n   */\n  niceExtent: function (opt) {\n    var extent = this._extent; // If extent start and end are same, expand them\n\n    if (extent[0] === extent[1]) {\n      // Expand extent\n      extent[0] -= ONE_DAY;\n      extent[1] += ONE_DAY;\n    } // If there are no data and extent are [Infinity, -Infinity]\n\n\n    if (extent[1] === -Infinity && extent[0] === Infinity) {\n      var d = new Date();\n      extent[1] = +new Date(d.getFullYear(), d.getMonth(), d.getDate());\n      extent[0] = extent[1] - ONE_DAY;\n    }\n\n    this.niceTicks(opt.splitNumber, opt.minInterval, opt.maxInterval); // var extent = this._extent;\n\n    var interval = this._interval;\n\n    if (!opt.fixMin) {\n      extent[0] = numberUtil.round(mathFloor(extent[0] / interval) * interval);\n    }\n\n    if (!opt.fixMax) {\n      extent[1] = numberUtil.round(mathCeil(extent[1] / interval) * interval);\n    }\n  },\n\n  /**\n   * @override\n   */\n  niceTicks: function (approxTickNum, minInterval, maxInterval) {\n    approxTickNum = approxTickNum || 10;\n    var extent = this._extent;\n    var span = extent[1] - extent[0];\n    var approxInterval = span / approxTickNum;\n\n    if (minInterval != null && approxInterval < minInterval) {\n      approxInterval = minInterval;\n    }\n\n    if (maxInterval != null && approxInterval > maxInterval) {\n      approxInterval = maxInterval;\n    }\n\n    var scaleLevelsLen = scaleLevels.length;\n    var idx = bisect(scaleLevels, approxInterval, 0, scaleLevelsLen);\n    var level = scaleLevels[Math.min(idx, scaleLevelsLen - 1)];\n    var interval = level[1]; // Same with interval scale if span is much larger than 1 year\n\n    if (level[0] === 'year') {\n      var yearSpan = span / interval; // From \"Nice Numbers for Graph Labels\" of Graphic Gems\n      // var niceYearSpan = numberUtil.nice(yearSpan, false);\n\n      var yearStep = numberUtil.nice(yearSpan / approxTickNum, true);\n      interval *= yearStep;\n    }\n\n    var timezoneOffset = this.getSetting('useUTC') ? 0 : new Date(+extent[0] || +extent[1]).getTimezoneOffset() * 60 * 1000;\n    var niceExtent = [Math.round(mathCeil((extent[0] - timezoneOffset) / interval) * interval + timezoneOffset), Math.round(mathFloor((extent[1] - timezoneOffset) / interval) * interval + timezoneOffset)];\n    scaleHelper.fixExtent(niceExtent, extent);\n    this._stepLvl = level; // Interval will be used in getTicks\n\n    this._interval = interval;\n    this._niceExtent = niceExtent;\n  },\n  parse: function (val) {\n    // val might be float.\n    return +numberUtil.parseDate(val);\n  }\n});\nzrUtil.each(['contain', 'normalize'], function (methodName) {\n  TimeScale.prototype[methodName] = function (val) {\n    return intervalScaleProto[methodName].call(this, this.parse(val));\n  };\n});\n/**\n * This implementation was originally copied from \"d3.js\"\n * <https://github.com/d3/d3/blob/b516d77fb8566b576088e73410437494717ada26/src/time/scale.js>\n * with some modifications made for this program.\n * See the license statement at the head of this file.\n */\n\nvar scaleLevels = [// Format              interval\n['hh:mm:ss', ONE_SECOND], // 1s\n['hh:mm:ss', ONE_SECOND * 5], // 5s\n['hh:mm:ss', ONE_SECOND * 10], // 10s\n['hh:mm:ss', ONE_SECOND * 15], // 15s\n['hh:mm:ss', ONE_SECOND * 30], // 30s\n['hh:mm\\nMM-dd', ONE_MINUTE], // 1m\n['hh:mm\\nMM-dd', ONE_MINUTE * 5], // 5m\n['hh:mm\\nMM-dd', ONE_MINUTE * 10], // 10m\n['hh:mm\\nMM-dd', ONE_MINUTE * 15], // 15m\n['hh:mm\\nMM-dd', ONE_MINUTE * 30], // 30m\n['hh:mm\\nMM-dd', ONE_HOUR], // 1h\n['hh:mm\\nMM-dd', ONE_HOUR * 2], // 2h\n['hh:mm\\nMM-dd', ONE_HOUR * 6], // 6h\n['hh:mm\\nMM-dd', ONE_HOUR * 12], // 12h\n['MM-dd\\nyyyy', ONE_DAY], // 1d\n['MM-dd\\nyyyy', ONE_DAY * 2], // 2d\n['MM-dd\\nyyyy', ONE_DAY * 3], // 3d\n['MM-dd\\nyyyy', ONE_DAY * 4], // 4d\n['MM-dd\\nyyyy', ONE_DAY * 5], // 5d\n['MM-dd\\nyyyy', ONE_DAY * 6], // 6d\n['week', ONE_DAY * 7], // 7d\n['MM-dd\\nyyyy', ONE_DAY * 10], // 10d\n['week', ONE_DAY * 14], // 2w\n['week', ONE_DAY * 21], // 3w\n['month', ONE_DAY * 31], // 1M\n['week', ONE_DAY * 42], // 6w\n['month', ONE_DAY * 62], // 2M\n['week', ONE_DAY * 70], // 10w\n['quarter', ONE_DAY * 95], // 3M\n['month', ONE_DAY * 31 * 4], // 4M\n['month', ONE_DAY * 31 * 5], // 5M\n['half-year', ONE_DAY * 380 / 2], // 6M\n['month', ONE_DAY * 31 * 8], // 8M\n['month', ONE_DAY * 31 * 10], // 10M\n['year', ONE_DAY * 380] // 1Y\n];\n/**\n * @param {module:echarts/model/Model}\n * @return {module:echarts/scale/Time}\n */\n\nTimeScale.create = function (model) {\n  return new TimeScale({\n    useUTC: model.ecModel.get('useUTC')\n  });\n};\n\nvar _default = TimeScale;\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}