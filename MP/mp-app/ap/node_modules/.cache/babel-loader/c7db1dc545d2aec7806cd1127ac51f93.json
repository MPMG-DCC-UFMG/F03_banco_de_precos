{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar graphic = require(\"../../util/graphic\");\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\nvar NodeHighlightPolicy = {\n  NONE: 'none',\n  // not downplay others\n  DESCENDANT: 'descendant',\n  ANCESTOR: 'ancestor',\n  SELF: 'self'\n};\nvar DEFAULT_SECTOR_Z = 2;\nvar DEFAULT_TEXT_Z = 4;\n/**\n * Sunburstce of Sunburst including Sector, Label, LabelLine\n * @constructor\n * @extends {module:zrender/graphic/Group}\n */\n\nfunction SunburstPiece(node, seriesModel, ecModel) {\n  graphic.Group.call(this);\n  var sector = new graphic.Sector({\n    z2: DEFAULT_SECTOR_Z\n  });\n  sector.seriesIndex = seriesModel.seriesIndex;\n  var text = new graphic.Text({\n    z2: DEFAULT_TEXT_Z,\n    silent: node.getModel('label').get('silent')\n  });\n  this.add(sector);\n  this.add(text);\n  this.updateData(true, node, 'normal', seriesModel, ecModel); // Hover to change label and labelLine\n\n  function onEmphasis() {\n    text.ignore = text.hoverIgnore;\n  }\n\n  function onNormal() {\n    text.ignore = text.normalIgnore;\n  }\n\n  this.on('emphasis', onEmphasis).on('normal', onNormal).on('mouseover', onEmphasis).on('mouseout', onNormal);\n}\n\nvar SunburstPieceProto = SunburstPiece.prototype;\n\nSunburstPieceProto.updateData = function (firstCreate, node, state, seriesModel, ecModel) {\n  this.node = node;\n  node.piece = this;\n  seriesModel = seriesModel || this._seriesModel;\n  ecModel = ecModel || this._ecModel;\n  var sector = this.childAt(0);\n  sector.dataIndex = node.dataIndex;\n  var itemModel = node.getModel();\n  var layout = node.getLayout(); // if (!layout) {\n  //     console.log(node.getLayout());\n  // }\n\n  var sectorShape = zrUtil.extend({}, layout);\n  sectorShape.label = null;\n  var visualColor = getNodeColor(node, seriesModel, ecModel);\n  fillDefaultColor(node, seriesModel, visualColor);\n  var normalStyle = itemModel.getModel('itemStyle').getItemStyle();\n  var style;\n\n  if (state === 'normal') {\n    style = normalStyle;\n  } else {\n    var stateStyle = itemModel.getModel(state + '.itemStyle').getItemStyle();\n    style = zrUtil.merge(stateStyle, normalStyle);\n  }\n\n  style = zrUtil.defaults({\n    lineJoin: 'bevel',\n    fill: style.fill || visualColor\n  }, style);\n\n  if (firstCreate) {\n    sector.setShape(sectorShape);\n    sector.shape.r = layout.r0;\n    graphic.updateProps(sector, {\n      shape: {\n        r: layout.r\n      }\n    }, seriesModel, node.dataIndex);\n    sector.useStyle(style);\n  } else if (typeof style.fill === 'object' && style.fill.type || typeof sector.style.fill === 'object' && sector.style.fill.type) {\n    // Disable animation for gradient since no interpolation method\n    // is supported for gradient\n    graphic.updateProps(sector, {\n      shape: sectorShape\n    }, seriesModel);\n    sector.useStyle(style);\n  } else {\n    graphic.updateProps(sector, {\n      shape: sectorShape,\n      style: style\n    }, seriesModel);\n  }\n\n  this._updateLabel(seriesModel, visualColor, state);\n\n  var cursorStyle = itemModel.getShallow('cursor');\n  cursorStyle && sector.attr('cursor', cursorStyle);\n\n  if (firstCreate) {\n    var highlightPolicy = seriesModel.getShallow('highlightPolicy');\n\n    this._initEvents(sector, node, seriesModel, highlightPolicy);\n  }\n\n  this._seriesModel = seriesModel || this._seriesModel;\n  this._ecModel = ecModel || this._ecModel;\n  graphic.setHoverStyle(this);\n};\n\nSunburstPieceProto.onEmphasis = function (highlightPolicy) {\n  var that = this;\n  this.node.hostTree.root.eachNode(function (n) {\n    if (n.piece) {\n      if (that.node === n) {\n        n.piece.updateData(false, n, 'emphasis');\n      } else if (isNodeHighlighted(n, that.node, highlightPolicy)) {\n        n.piece.childAt(0).trigger('highlight');\n      } else if (highlightPolicy !== NodeHighlightPolicy.NONE) {\n        n.piece.childAt(0).trigger('downplay');\n      }\n    }\n  });\n};\n\nSunburstPieceProto.onNormal = function () {\n  this.node.hostTree.root.eachNode(function (n) {\n    if (n.piece) {\n      n.piece.updateData(false, n, 'normal');\n    }\n  });\n};\n\nSunburstPieceProto.onHighlight = function () {\n  this.updateData(false, this.node, 'highlight');\n};\n\nSunburstPieceProto.onDownplay = function () {\n  this.updateData(false, this.node, 'downplay');\n};\n\nSunburstPieceProto._updateLabel = function (seriesModel, visualColor, state) {\n  var itemModel = this.node.getModel();\n  var normalModel = itemModel.getModel('label');\n  var labelModel = state === 'normal' || state === 'emphasis' ? normalModel : itemModel.getModel(state + '.label');\n  var labelHoverModel = itemModel.getModel('emphasis.label');\n  var labelFormatter = labelModel.get('formatter'); // Use normal formatter if no state formatter is defined\n\n  var labelState = labelFormatter ? state : 'normal';\n  var text = zrUtil.retrieve(seriesModel.getFormattedLabel(this.node.dataIndex, labelState, null, null, 'label'), this.node.name);\n\n  if (getLabelAttr('show') === false) {\n    text = '';\n  }\n\n  var layout = this.node.getLayout();\n  var labelMinAngle = labelModel.get('minAngle');\n\n  if (labelMinAngle == null) {\n    labelMinAngle = normalModel.get('minAngle');\n  }\n\n  labelMinAngle = labelMinAngle / 180 * Math.PI;\n  var angle = layout.endAngle - layout.startAngle;\n\n  if (labelMinAngle != null && Math.abs(angle) < labelMinAngle) {\n    // Not displaying text when angle is too small\n    text = '';\n  }\n\n  var label = this.childAt(1);\n  graphic.setLabelStyle(label.style, label.hoverStyle || {}, normalModel, labelHoverModel, {\n    defaultText: labelModel.getShallow('show') ? text : null,\n    autoColor: visualColor,\n    useInsideStyle: true\n  });\n  var midAngle = (layout.startAngle + layout.endAngle) / 2;\n  var dx = Math.cos(midAngle);\n  var dy = Math.sin(midAngle);\n  var r;\n  var labelPosition = getLabelAttr('position');\n  var labelPadding = getLabelAttr('distance') || 0;\n  var textAlign = getLabelAttr('align');\n\n  if (labelPosition === 'outside') {\n    r = layout.r + labelPadding;\n    textAlign = midAngle > Math.PI / 2 ? 'right' : 'left';\n  } else {\n    if (!textAlign || textAlign === 'center') {\n      r = (layout.r + layout.r0) / 2;\n      textAlign = 'center';\n    } else if (textAlign === 'left') {\n      r = layout.r0 + labelPadding;\n\n      if (midAngle > Math.PI / 2) {\n        textAlign = 'right';\n      }\n    } else if (textAlign === 'right') {\n      r = layout.r - labelPadding;\n\n      if (midAngle > Math.PI / 2) {\n        textAlign = 'left';\n      }\n    }\n  }\n\n  label.attr('style', {\n    text: text,\n    textAlign: textAlign,\n    textVerticalAlign: getLabelAttr('verticalAlign') || 'middle',\n    opacity: getLabelAttr('opacity')\n  });\n  var textX = r * dx + layout.cx;\n  var textY = r * dy + layout.cy;\n  label.attr('position', [textX, textY]);\n  var rotateType = getLabelAttr('rotate');\n  var rotate = 0;\n\n  if (rotateType === 'radial') {\n    rotate = -midAngle;\n\n    if (rotate < -Math.PI / 2) {\n      rotate += Math.PI;\n    }\n  } else if (rotateType === 'tangential') {\n    rotate = Math.PI / 2 - midAngle;\n\n    if (rotate > Math.PI / 2) {\n      rotate -= Math.PI;\n    } else if (rotate < -Math.PI / 2) {\n      rotate += Math.PI;\n    }\n  } else if (typeof rotateType === 'number') {\n    rotate = rotateType * Math.PI / 180;\n  }\n\n  label.attr('rotation', rotate);\n\n  function getLabelAttr(name) {\n    var stateAttr = labelModel.get(name);\n\n    if (stateAttr == null) {\n      return normalModel.get(name);\n    } else {\n      return stateAttr;\n    }\n  }\n};\n\nSunburstPieceProto._initEvents = function (sector, node, seriesModel, highlightPolicy) {\n  sector.off('mouseover').off('mouseout').off('emphasis').off('normal');\n  var that = this;\n\n  var onEmphasis = function onEmphasis() {\n    that.onEmphasis(highlightPolicy);\n  };\n\n  var onNormal = function onNormal() {\n    that.onNormal();\n  };\n\n  var onDownplay = function onDownplay() {\n    that.onDownplay();\n  };\n\n  var onHighlight = function onHighlight() {\n    that.onHighlight();\n  };\n\n  if (seriesModel.isAnimationEnabled()) {\n    sector.on('mouseover', onEmphasis).on('mouseout', onNormal).on('emphasis', onEmphasis).on('normal', onNormal).on('downplay', onDownplay).on('highlight', onHighlight);\n  }\n};\n\nzrUtil.inherits(SunburstPiece, graphic.Group);\nvar _default = SunburstPiece;\n/**\n * Get node color\n *\n * @param {TreeNode} node the node to get color\n * @param {module:echarts/model/Series} seriesModel series\n * @param {module:echarts/model/Global} ecModel echarts defaults\n */\n\nfunction getNodeColor(node, seriesModel, ecModel) {\n  // Color from visualMap\n  var visualColor = node.getVisual('color');\n  var visualMetaList = node.getVisual('visualMeta');\n\n  if (!visualMetaList || visualMetaList.length === 0) {\n    // Use first-generation color if has no visualMap\n    visualColor = null;\n  } // Self color or level color\n\n\n  var color = node.getModel('itemStyle').get('color');\n\n  if (color) {\n    return color;\n  } else if (visualColor) {\n    // Color mapping\n    return visualColor;\n  } else if (node.depth === 0) {\n    // Virtual root node\n    return ecModel.option.color[0];\n  } else {\n    // First-generation color\n    var length = ecModel.option.color.length;\n    color = ecModel.option.color[getRootId(node) % length];\n  }\n\n  return color;\n}\n/**\n * Get index of root in sorted order\n *\n * @param {TreeNode} node current node\n * @return {number} index in root\n */\n\n\nfunction getRootId(node) {\n  var ancestor = node;\n\n  while (ancestor.depth > 1) {\n    ancestor = ancestor.parentNode;\n  }\n\n  var virtualRoot = node.getAncestors()[0];\n  return zrUtil.indexOf(virtualRoot.children, ancestor);\n}\n\nfunction isNodeHighlighted(node, activeNode, policy) {\n  if (policy === NodeHighlightPolicy.NONE) {\n    return false;\n  } else if (policy === NodeHighlightPolicy.SELF) {\n    return node === activeNode;\n  } else if (policy === NodeHighlightPolicy.ANCESTOR) {\n    return node === activeNode || node.isAncestorOf(activeNode);\n  } else {\n    return node === activeNode || node.isDescendantOf(activeNode);\n  }\n} // Fix tooltip callback function params.color incorrect when pick a default color\n\n\nfunction fillDefaultColor(node, seriesModel, color) {\n  var data = seriesModel.getData();\n  data.setItemVisual(node.dataIndex, 'color', color);\n}\n\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/echarts/lib/chart/sunburst/SunburstPiece.js"],"names":["zrUtil","require","graphic","NodeHighlightPolicy","NONE","DESCENDANT","ANCESTOR","SELF","DEFAULT_SECTOR_Z","DEFAULT_TEXT_Z","SunburstPiece","node","seriesModel","ecModel","Group","call","sector","Sector","z2","seriesIndex","text","Text","silent","getModel","get","add","updateData","onEmphasis","ignore","hoverIgnore","onNormal","normalIgnore","on","SunburstPieceProto","prototype","firstCreate","state","piece","_seriesModel","_ecModel","childAt","dataIndex","itemModel","layout","getLayout","sectorShape","extend","label","visualColor","getNodeColor","fillDefaultColor","normalStyle","getItemStyle","style","stateStyle","merge","defaults","lineJoin","fill","setShape","shape","r","r0","updateProps","useStyle","type","_updateLabel","cursorStyle","getShallow","attr","highlightPolicy","_initEvents","setHoverStyle","that","hostTree","root","eachNode","n","isNodeHighlighted","trigger","onHighlight","onDownplay","normalModel","labelModel","labelHoverModel","labelFormatter","labelState","retrieve","getFormattedLabel","name","getLabelAttr","labelMinAngle","Math","PI","angle","endAngle","startAngle","abs","setLabelStyle","hoverStyle","defaultText","autoColor","useInsideStyle","midAngle","dx","cos","dy","sin","labelPosition","labelPadding","textAlign","textVerticalAlign","opacity","textX","cx","textY","cy","rotateType","rotate","stateAttr","off","isAnimationEnabled","inherits","_default","getVisual","visualMetaList","length","color","depth","option","getRootId","ancestor","parentNode","virtualRoot","getAncestors","indexOf","children","activeNode","policy","isAncestorOf","isDescendantOf","data","getData","setItemVisual","module","exports"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar graphic = require(\"../../util/graphic\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar NodeHighlightPolicy = {\n  NONE: 'none',\n  // not downplay others\n  DESCENDANT: 'descendant',\n  ANCESTOR: 'ancestor',\n  SELF: 'self'\n};\nvar DEFAULT_SECTOR_Z = 2;\nvar DEFAULT_TEXT_Z = 4;\n/**\n * Sunburstce of Sunburst including Sector, Label, LabelLine\n * @constructor\n * @extends {module:zrender/graphic/Group}\n */\n\nfunction SunburstPiece(node, seriesModel, ecModel) {\n  graphic.Group.call(this);\n  var sector = new graphic.Sector({\n    z2: DEFAULT_SECTOR_Z\n  });\n  sector.seriesIndex = seriesModel.seriesIndex;\n  var text = new graphic.Text({\n    z2: DEFAULT_TEXT_Z,\n    silent: node.getModel('label').get('silent')\n  });\n  this.add(sector);\n  this.add(text);\n  this.updateData(true, node, 'normal', seriesModel, ecModel); // Hover to change label and labelLine\n\n  function onEmphasis() {\n    text.ignore = text.hoverIgnore;\n  }\n\n  function onNormal() {\n    text.ignore = text.normalIgnore;\n  }\n\n  this.on('emphasis', onEmphasis).on('normal', onNormal).on('mouseover', onEmphasis).on('mouseout', onNormal);\n}\n\nvar SunburstPieceProto = SunburstPiece.prototype;\n\nSunburstPieceProto.updateData = function (firstCreate, node, state, seriesModel, ecModel) {\n  this.node = node;\n  node.piece = this;\n  seriesModel = seriesModel || this._seriesModel;\n  ecModel = ecModel || this._ecModel;\n  var sector = this.childAt(0);\n  sector.dataIndex = node.dataIndex;\n  var itemModel = node.getModel();\n  var layout = node.getLayout(); // if (!layout) {\n  //     console.log(node.getLayout());\n  // }\n\n  var sectorShape = zrUtil.extend({}, layout);\n  sectorShape.label = null;\n  var visualColor = getNodeColor(node, seriesModel, ecModel);\n  fillDefaultColor(node, seriesModel, visualColor);\n  var normalStyle = itemModel.getModel('itemStyle').getItemStyle();\n  var style;\n\n  if (state === 'normal') {\n    style = normalStyle;\n  } else {\n    var stateStyle = itemModel.getModel(state + '.itemStyle').getItemStyle();\n    style = zrUtil.merge(stateStyle, normalStyle);\n  }\n\n  style = zrUtil.defaults({\n    lineJoin: 'bevel',\n    fill: style.fill || visualColor\n  }, style);\n\n  if (firstCreate) {\n    sector.setShape(sectorShape);\n    sector.shape.r = layout.r0;\n    graphic.updateProps(sector, {\n      shape: {\n        r: layout.r\n      }\n    }, seriesModel, node.dataIndex);\n    sector.useStyle(style);\n  } else if (typeof style.fill === 'object' && style.fill.type || typeof sector.style.fill === 'object' && sector.style.fill.type) {\n    // Disable animation for gradient since no interpolation method\n    // is supported for gradient\n    graphic.updateProps(sector, {\n      shape: sectorShape\n    }, seriesModel);\n    sector.useStyle(style);\n  } else {\n    graphic.updateProps(sector, {\n      shape: sectorShape,\n      style: style\n    }, seriesModel);\n  }\n\n  this._updateLabel(seriesModel, visualColor, state);\n\n  var cursorStyle = itemModel.getShallow('cursor');\n  cursorStyle && sector.attr('cursor', cursorStyle);\n\n  if (firstCreate) {\n    var highlightPolicy = seriesModel.getShallow('highlightPolicy');\n\n    this._initEvents(sector, node, seriesModel, highlightPolicy);\n  }\n\n  this._seriesModel = seriesModel || this._seriesModel;\n  this._ecModel = ecModel || this._ecModel;\n  graphic.setHoverStyle(this);\n};\n\nSunburstPieceProto.onEmphasis = function (highlightPolicy) {\n  var that = this;\n  this.node.hostTree.root.eachNode(function (n) {\n    if (n.piece) {\n      if (that.node === n) {\n        n.piece.updateData(false, n, 'emphasis');\n      } else if (isNodeHighlighted(n, that.node, highlightPolicy)) {\n        n.piece.childAt(0).trigger('highlight');\n      } else if (highlightPolicy !== NodeHighlightPolicy.NONE) {\n        n.piece.childAt(0).trigger('downplay');\n      }\n    }\n  });\n};\n\nSunburstPieceProto.onNormal = function () {\n  this.node.hostTree.root.eachNode(function (n) {\n    if (n.piece) {\n      n.piece.updateData(false, n, 'normal');\n    }\n  });\n};\n\nSunburstPieceProto.onHighlight = function () {\n  this.updateData(false, this.node, 'highlight');\n};\n\nSunburstPieceProto.onDownplay = function () {\n  this.updateData(false, this.node, 'downplay');\n};\n\nSunburstPieceProto._updateLabel = function (seriesModel, visualColor, state) {\n  var itemModel = this.node.getModel();\n  var normalModel = itemModel.getModel('label');\n  var labelModel = state === 'normal' || state === 'emphasis' ? normalModel : itemModel.getModel(state + '.label');\n  var labelHoverModel = itemModel.getModel('emphasis.label');\n  var labelFormatter = labelModel.get('formatter'); // Use normal formatter if no state formatter is defined\n\n  var labelState = labelFormatter ? state : 'normal';\n  var text = zrUtil.retrieve(seriesModel.getFormattedLabel(this.node.dataIndex, labelState, null, null, 'label'), this.node.name);\n\n  if (getLabelAttr('show') === false) {\n    text = '';\n  }\n\n  var layout = this.node.getLayout();\n  var labelMinAngle = labelModel.get('minAngle');\n\n  if (labelMinAngle == null) {\n    labelMinAngle = normalModel.get('minAngle');\n  }\n\n  labelMinAngle = labelMinAngle / 180 * Math.PI;\n  var angle = layout.endAngle - layout.startAngle;\n\n  if (labelMinAngle != null && Math.abs(angle) < labelMinAngle) {\n    // Not displaying text when angle is too small\n    text = '';\n  }\n\n  var label = this.childAt(1);\n  graphic.setLabelStyle(label.style, label.hoverStyle || {}, normalModel, labelHoverModel, {\n    defaultText: labelModel.getShallow('show') ? text : null,\n    autoColor: visualColor,\n    useInsideStyle: true\n  });\n  var midAngle = (layout.startAngle + layout.endAngle) / 2;\n  var dx = Math.cos(midAngle);\n  var dy = Math.sin(midAngle);\n  var r;\n  var labelPosition = getLabelAttr('position');\n  var labelPadding = getLabelAttr('distance') || 0;\n  var textAlign = getLabelAttr('align');\n\n  if (labelPosition === 'outside') {\n    r = layout.r + labelPadding;\n    textAlign = midAngle > Math.PI / 2 ? 'right' : 'left';\n  } else {\n    if (!textAlign || textAlign === 'center') {\n      r = (layout.r + layout.r0) / 2;\n      textAlign = 'center';\n    } else if (textAlign === 'left') {\n      r = layout.r0 + labelPadding;\n\n      if (midAngle > Math.PI / 2) {\n        textAlign = 'right';\n      }\n    } else if (textAlign === 'right') {\n      r = layout.r - labelPadding;\n\n      if (midAngle > Math.PI / 2) {\n        textAlign = 'left';\n      }\n    }\n  }\n\n  label.attr('style', {\n    text: text,\n    textAlign: textAlign,\n    textVerticalAlign: getLabelAttr('verticalAlign') || 'middle',\n    opacity: getLabelAttr('opacity')\n  });\n  var textX = r * dx + layout.cx;\n  var textY = r * dy + layout.cy;\n  label.attr('position', [textX, textY]);\n  var rotateType = getLabelAttr('rotate');\n  var rotate = 0;\n\n  if (rotateType === 'radial') {\n    rotate = -midAngle;\n\n    if (rotate < -Math.PI / 2) {\n      rotate += Math.PI;\n    }\n  } else if (rotateType === 'tangential') {\n    rotate = Math.PI / 2 - midAngle;\n\n    if (rotate > Math.PI / 2) {\n      rotate -= Math.PI;\n    } else if (rotate < -Math.PI / 2) {\n      rotate += Math.PI;\n    }\n  } else if (typeof rotateType === 'number') {\n    rotate = rotateType * Math.PI / 180;\n  }\n\n  label.attr('rotation', rotate);\n\n  function getLabelAttr(name) {\n    var stateAttr = labelModel.get(name);\n\n    if (stateAttr == null) {\n      return normalModel.get(name);\n    } else {\n      return stateAttr;\n    }\n  }\n};\n\nSunburstPieceProto._initEvents = function (sector, node, seriesModel, highlightPolicy) {\n  sector.off('mouseover').off('mouseout').off('emphasis').off('normal');\n  var that = this;\n\n  var onEmphasis = function () {\n    that.onEmphasis(highlightPolicy);\n  };\n\n  var onNormal = function () {\n    that.onNormal();\n  };\n\n  var onDownplay = function () {\n    that.onDownplay();\n  };\n\n  var onHighlight = function () {\n    that.onHighlight();\n  };\n\n  if (seriesModel.isAnimationEnabled()) {\n    sector.on('mouseover', onEmphasis).on('mouseout', onNormal).on('emphasis', onEmphasis).on('normal', onNormal).on('downplay', onDownplay).on('highlight', onHighlight);\n  }\n};\n\nzrUtil.inherits(SunburstPiece, graphic.Group);\nvar _default = SunburstPiece;\n/**\n * Get node color\n *\n * @param {TreeNode} node the node to get color\n * @param {module:echarts/model/Series} seriesModel series\n * @param {module:echarts/model/Global} ecModel echarts defaults\n */\n\nfunction getNodeColor(node, seriesModel, ecModel) {\n  // Color from visualMap\n  var visualColor = node.getVisual('color');\n  var visualMetaList = node.getVisual('visualMeta');\n\n  if (!visualMetaList || visualMetaList.length === 0) {\n    // Use first-generation color if has no visualMap\n    visualColor = null;\n  } // Self color or level color\n\n\n  var color = node.getModel('itemStyle').get('color');\n\n  if (color) {\n    return color;\n  } else if (visualColor) {\n    // Color mapping\n    return visualColor;\n  } else if (node.depth === 0) {\n    // Virtual root node\n    return ecModel.option.color[0];\n  } else {\n    // First-generation color\n    var length = ecModel.option.color.length;\n    color = ecModel.option.color[getRootId(node) % length];\n  }\n\n  return color;\n}\n/**\n * Get index of root in sorted order\n *\n * @param {TreeNode} node current node\n * @return {number} index in root\n */\n\n\nfunction getRootId(node) {\n  var ancestor = node;\n\n  while (ancestor.depth > 1) {\n    ancestor = ancestor.parentNode;\n  }\n\n  var virtualRoot = node.getAncestors()[0];\n  return zrUtil.indexOf(virtualRoot.children, ancestor);\n}\n\nfunction isNodeHighlighted(node, activeNode, policy) {\n  if (policy === NodeHighlightPolicy.NONE) {\n    return false;\n  } else if (policy === NodeHighlightPolicy.SELF) {\n    return node === activeNode;\n  } else if (policy === NodeHighlightPolicy.ANCESTOR) {\n    return node === activeNode || node.isAncestorOf(activeNode);\n  } else {\n    return node === activeNode || node.isDescendantOf(activeNode);\n  }\n} // Fix tooltip callback function params.color incorrect when pick a default color\n\n\nfunction fillDefaultColor(node, seriesModel, color) {\n  var data = seriesModel.getData();\n  data.setItemVisual(node.dataIndex, 'color', color);\n}\n\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}