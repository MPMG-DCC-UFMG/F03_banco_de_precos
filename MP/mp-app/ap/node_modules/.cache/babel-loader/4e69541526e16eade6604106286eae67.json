{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar lang = require(\"../lang\");\n\nvar _dataProvider = require(\"../data/helper/dataProvider\");\n\nvar retrieveRawValue = _dataProvider.retrieveRawValue;\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nfunction _default(dom, ecModel) {\n  var ariaModel = ecModel.getModel('aria');\n\n  if (!ariaModel.get('show')) {\n    return;\n  } else if (ariaModel.get('description')) {\n    dom.setAttribute('aria-label', ariaModel.get('description'));\n    return;\n  }\n\n  var seriesCnt = 0;\n  ecModel.eachSeries(function (seriesModel, idx) {\n    ++seriesCnt;\n  }, this);\n  var maxDataCnt = ariaModel.get('data.maxCount') || 10;\n  var maxSeriesCnt = ariaModel.get('series.maxCount') || 10;\n  var displaySeriesCnt = Math.min(seriesCnt, maxSeriesCnt);\n  var ariaLabel;\n\n  if (seriesCnt < 1) {\n    // No series, no aria label\n    return;\n  } else {\n    var title = getTitle();\n\n    if (title) {\n      ariaLabel = replace(getConfig('general.withTitle'), {\n        title: title\n      });\n    } else {\n      ariaLabel = getConfig('general.withoutTitle');\n    }\n\n    var seriesLabels = [];\n    var prefix = seriesCnt > 1 ? 'series.multiple.prefix' : 'series.single.prefix';\n    ariaLabel += replace(getConfig(prefix), {\n      seriesCount: seriesCnt\n    });\n    ecModel.eachSeries(function (seriesModel, idx) {\n      if (idx < displaySeriesCnt) {\n        var seriesLabel;\n        var seriesName = seriesModel.get('name');\n        var seriesTpl = 'series.' + (seriesCnt > 1 ? 'multiple' : 'single') + '.';\n        seriesLabel = getConfig(seriesName ? seriesTpl + 'withName' : seriesTpl + 'withoutName');\n        seriesLabel = replace(seriesLabel, {\n          seriesId: seriesModel.seriesIndex,\n          seriesName: seriesModel.get('name'),\n          seriesType: getSeriesTypeName(seriesModel.subType)\n        });\n        var data = seriesModel.getData();\n        window.data = data;\n\n        if (data.count() > maxDataCnt) {\n          // Show part of data\n          seriesLabel += replace(getConfig('data.partialData'), {\n            displayCnt: maxDataCnt\n          });\n        } else {\n          seriesLabel += getConfig('data.allData');\n        }\n\n        var dataLabels = [];\n\n        for (var i = 0; i < data.count(); i++) {\n          if (i < maxDataCnt) {\n            var name = data.getName(i);\n            var value = retrieveRawValue(data, i);\n            dataLabels.push(replace(name ? getConfig('data.withName') : getConfig('data.withoutName'), {\n              name: name,\n              value: value\n            }));\n          }\n        }\n\n        seriesLabel += dataLabels.join(getConfig('data.separator.middle')) + getConfig('data.separator.end');\n        seriesLabels.push(seriesLabel);\n      }\n    });\n    ariaLabel += seriesLabels.join(getConfig('series.multiple.separator.middle')) + getConfig('series.multiple.separator.end');\n    dom.setAttribute('aria-label', ariaLabel);\n  }\n\n  function replace(str, keyValues) {\n    if (typeof str !== 'string') {\n      return str;\n    }\n\n    var result = str;\n    zrUtil.each(keyValues, function (value, key) {\n      result = result.replace(new RegExp('\\\\{\\\\s*' + key + '\\\\s*\\\\}', 'g'), value);\n    });\n    return result;\n  }\n\n  function getConfig(path) {\n    var userConfig = ariaModel.get(path);\n\n    if (userConfig == null) {\n      var pathArr = path.split('.');\n      var result = lang.aria;\n\n      for (var i = 0; i < pathArr.length; ++i) {\n        result = result[pathArr[i]];\n      }\n\n      return result;\n    } else {\n      return userConfig;\n    }\n  }\n\n  function getTitle() {\n    var title = ecModel.getModel('title').option;\n\n    if (title && title.length) {\n      title = title[0];\n    }\n\n    return title && title.text;\n  }\n\n  function getSeriesTypeName(type) {\n    return lang.series.typeNames[type] || '自定义图';\n  }\n}\n\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/echarts/lib/visual/aria.js"],"names":["zrUtil","require","lang","_dataProvider","retrieveRawValue","_default","dom","ecModel","ariaModel","getModel","get","setAttribute","seriesCnt","eachSeries","seriesModel","idx","maxDataCnt","maxSeriesCnt","displaySeriesCnt","Math","min","ariaLabel","title","getTitle","replace","getConfig","seriesLabels","prefix","seriesCount","seriesLabel","seriesName","seriesTpl","seriesId","seriesIndex","seriesType","getSeriesTypeName","subType","data","getData","window","count","displayCnt","dataLabels","i","name","getName","value","push","join","str","keyValues","result","each","key","RegExp","path","userConfig","pathArr","split","aria","length","option","text","type","series","typeNames","module","exports"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar lang = require(\"../lang\");\n\nvar _dataProvider = require(\"../data/helper/dataProvider\");\n\nvar retrieveRawValue = _dataProvider.retrieveRawValue;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction _default(dom, ecModel) {\n  var ariaModel = ecModel.getModel('aria');\n\n  if (!ariaModel.get('show')) {\n    return;\n  } else if (ariaModel.get('description')) {\n    dom.setAttribute('aria-label', ariaModel.get('description'));\n    return;\n  }\n\n  var seriesCnt = 0;\n  ecModel.eachSeries(function (seriesModel, idx) {\n    ++seriesCnt;\n  }, this);\n  var maxDataCnt = ariaModel.get('data.maxCount') || 10;\n  var maxSeriesCnt = ariaModel.get('series.maxCount') || 10;\n  var displaySeriesCnt = Math.min(seriesCnt, maxSeriesCnt);\n  var ariaLabel;\n\n  if (seriesCnt < 1) {\n    // No series, no aria label\n    return;\n  } else {\n    var title = getTitle();\n\n    if (title) {\n      ariaLabel = replace(getConfig('general.withTitle'), {\n        title: title\n      });\n    } else {\n      ariaLabel = getConfig('general.withoutTitle');\n    }\n\n    var seriesLabels = [];\n    var prefix = seriesCnt > 1 ? 'series.multiple.prefix' : 'series.single.prefix';\n    ariaLabel += replace(getConfig(prefix), {\n      seriesCount: seriesCnt\n    });\n    ecModel.eachSeries(function (seriesModel, idx) {\n      if (idx < displaySeriesCnt) {\n        var seriesLabel;\n        var seriesName = seriesModel.get('name');\n        var seriesTpl = 'series.' + (seriesCnt > 1 ? 'multiple' : 'single') + '.';\n        seriesLabel = getConfig(seriesName ? seriesTpl + 'withName' : seriesTpl + 'withoutName');\n        seriesLabel = replace(seriesLabel, {\n          seriesId: seriesModel.seriesIndex,\n          seriesName: seriesModel.get('name'),\n          seriesType: getSeriesTypeName(seriesModel.subType)\n        });\n        var data = seriesModel.getData();\n        window.data = data;\n\n        if (data.count() > maxDataCnt) {\n          // Show part of data\n          seriesLabel += replace(getConfig('data.partialData'), {\n            displayCnt: maxDataCnt\n          });\n        } else {\n          seriesLabel += getConfig('data.allData');\n        }\n\n        var dataLabels = [];\n\n        for (var i = 0; i < data.count(); i++) {\n          if (i < maxDataCnt) {\n            var name = data.getName(i);\n            var value = retrieveRawValue(data, i);\n            dataLabels.push(replace(name ? getConfig('data.withName') : getConfig('data.withoutName'), {\n              name: name,\n              value: value\n            }));\n          }\n        }\n\n        seriesLabel += dataLabels.join(getConfig('data.separator.middle')) + getConfig('data.separator.end');\n        seriesLabels.push(seriesLabel);\n      }\n    });\n    ariaLabel += seriesLabels.join(getConfig('series.multiple.separator.middle')) + getConfig('series.multiple.separator.end');\n    dom.setAttribute('aria-label', ariaLabel);\n  }\n\n  function replace(str, keyValues) {\n    if (typeof str !== 'string') {\n      return str;\n    }\n\n    var result = str;\n    zrUtil.each(keyValues, function (value, key) {\n      result = result.replace(new RegExp('\\\\{\\\\s*' + key + '\\\\s*\\\\}', 'g'), value);\n    });\n    return result;\n  }\n\n  function getConfig(path) {\n    var userConfig = ariaModel.get(path);\n\n    if (userConfig == null) {\n      var pathArr = path.split('.');\n      var result = lang.aria;\n\n      for (var i = 0; i < pathArr.length; ++i) {\n        result = result[pathArr[i]];\n      }\n\n      return result;\n    } else {\n      return userConfig;\n    }\n  }\n\n  function getTitle() {\n    var title = ecModel.getModel('title').option;\n\n    if (title && title.length) {\n      title = title[0];\n    }\n\n    return title && title.text;\n  }\n\n  function getSeriesTypeName(type) {\n    return lang.series.typeNames[type] || '自定义图';\n  }\n}\n\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}