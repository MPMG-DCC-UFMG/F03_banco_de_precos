{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar eventTool = require(\"zrender/lib/core/event\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar throttle = require(\"../../util/throttle\");\n\nvar DataZoomView = require(\"./DataZoomView\");\n\nvar numberUtil = require(\"../../util/number\");\n\nvar layout = require(\"../../util/layout\");\n\nvar sliderMove = require(\"../helper/sliderMove\");\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n\nvar Rect = graphic.Rect;\nvar linearMap = numberUtil.linearMap;\nvar asc = numberUtil.asc;\nvar bind = zrUtil.bind;\nvar each = zrUtil.each; // Constants\n\nvar DEFAULT_LOCATION_EDGE_GAP = 7;\nvar DEFAULT_FRAME_BORDER_WIDTH = 1;\nvar DEFAULT_FILLER_SIZE = 30;\nvar HORIZONTAL = 'horizontal';\nvar VERTICAL = 'vertical';\nvar LABEL_GAP = 5;\nvar SHOW_DATA_SHADOW_SERIES_TYPE = ['line', 'bar', 'candlestick', 'scatter'];\nvar SliderZoomView = DataZoomView.extend({\n  type: 'dataZoom.slider',\n  init: function init(ecModel, api) {\n    /**\n     * @private\n     * @type {Object}\n     */\n    this._displayables = {};\n    /**\n     * @private\n     * @type {string}\n     */\n\n    this._orient;\n    /**\n     * [0, 100]\n     * @private\n     */\n\n    this._range;\n    /**\n     * [coord of the first handle, coord of the second handle]\n     * @private\n     */\n\n    this._handleEnds;\n    /**\n     * [length, thick]\n     * @private\n     * @type {Array.<number>}\n     */\n\n    this._size;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    this._handleWidth;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    this._handleHeight;\n    /**\n     * @private\n     */\n\n    this._location;\n    /**\n     * @private\n     */\n\n    this._dragging;\n    /**\n     * @private\n     */\n\n    this._dataShadowInfo;\n    this.api = api;\n  },\n\n  /**\n   * @override\n   */\n  render: function render(dataZoomModel, ecModel, api, payload) {\n    SliderZoomView.superApply(this, 'render', arguments);\n    throttle.createOrUpdate(this, '_dispatchZoomAction', this.dataZoomModel.get('throttle'), 'fixRate');\n    this._orient = dataZoomModel.get('orient');\n\n    if (this.dataZoomModel.get('show') === false) {\n      this.group.removeAll();\n      return;\n    } // Notice: this._resetInterval() should not be executed when payload.type\n    // is 'dataZoom', origin this._range should be maintained, otherwise 'pan'\n    // or 'zoom' info will be missed because of 'throttle' of this.dispatchAction,\n\n\n    if (!payload || payload.type !== 'dataZoom' || payload.from !== this.uid) {\n      this._buildView();\n    }\n\n    this._updateView();\n  },\n\n  /**\n   * @override\n   */\n  remove: function remove() {\n    SliderZoomView.superApply(this, 'remove', arguments);\n    throttle.clear(this, '_dispatchZoomAction');\n  },\n\n  /**\n   * @override\n   */\n  dispose: function dispose() {\n    SliderZoomView.superApply(this, 'dispose', arguments);\n    throttle.clear(this, '_dispatchZoomAction');\n  },\n  _buildView: function _buildView() {\n    var thisGroup = this.group;\n    thisGroup.removeAll();\n\n    this._resetLocation();\n\n    this._resetInterval();\n\n    var barGroup = this._displayables.barGroup = new graphic.Group();\n\n    this._renderBackground();\n\n    this._renderHandle();\n\n    this._renderDataShadow();\n\n    thisGroup.add(barGroup);\n\n    this._positionGroup();\n  },\n\n  /**\n   * @private\n   */\n  _resetLocation: function _resetLocation() {\n    var dataZoomModel = this.dataZoomModel;\n    var api = this.api; // If some of x/y/width/height are not specified,\n    // auto-adapt according to target grid.\n\n    var coordRect = this._findCoordRect();\n\n    var ecSize = {\n      width: api.getWidth(),\n      height: api.getHeight()\n    }; // Default align by coordinate system rect.\n\n    var positionInfo = this._orient === HORIZONTAL ? {\n      // Why using 'right', because right should be used in vertical,\n      // and it is better to be consistent for dealing with position param merge.\n      right: ecSize.width - coordRect.x - coordRect.width,\n      top: ecSize.height - DEFAULT_FILLER_SIZE - DEFAULT_LOCATION_EDGE_GAP,\n      width: coordRect.width,\n      height: DEFAULT_FILLER_SIZE\n    } : {\n      // vertical\n      right: DEFAULT_LOCATION_EDGE_GAP,\n      top: coordRect.y,\n      width: DEFAULT_FILLER_SIZE,\n      height: coordRect.height\n    }; // Do not write back to option and replace value 'ph', because\n    // the 'ph' value should be recalculated when resize.\n\n    var layoutParams = layout.getLayoutParams(dataZoomModel.option); // Replace the placeholder value.\n\n    zrUtil.each(['right', 'top', 'width', 'height'], function (name) {\n      if (layoutParams[name] === 'ph') {\n        layoutParams[name] = positionInfo[name];\n      }\n    });\n    var layoutRect = layout.getLayoutRect(layoutParams, ecSize, dataZoomModel.padding);\n    this._location = {\n      x: layoutRect.x,\n      y: layoutRect.y\n    };\n    this._size = [layoutRect.width, layoutRect.height];\n    this._orient === VERTICAL && this._size.reverse();\n  },\n\n  /**\n   * @private\n   */\n  _positionGroup: function _positionGroup() {\n    var thisGroup = this.group;\n    var location = this._location;\n    var orient = this._orient; // Just use the first axis to determine mapping.\n\n    var targetAxisModel = this.dataZoomModel.getFirstTargetAxisModel();\n    var inverse = targetAxisModel && targetAxisModel.get('inverse');\n    var barGroup = this._displayables.barGroup;\n    var otherAxisInverse = (this._dataShadowInfo || {}).otherAxisInverse; // Transform barGroup.\n\n    barGroup.attr(orient === HORIZONTAL && !inverse ? {\n      scale: otherAxisInverse ? [1, 1] : [1, -1]\n    } : orient === HORIZONTAL && inverse ? {\n      scale: otherAxisInverse ? [-1, 1] : [-1, -1]\n    } : orient === VERTICAL && !inverse ? {\n      scale: otherAxisInverse ? [1, -1] : [1, 1],\n      rotation: Math.PI / 2 // Dont use Math.PI, considering shadow direction.\n\n    } : {\n      scale: otherAxisInverse ? [-1, -1] : [-1, 1],\n      rotation: Math.PI / 2\n    }); // Position barGroup\n\n    var rect = thisGroup.getBoundingRect([barGroup]);\n    thisGroup.attr('position', [location.x - rect.x, location.y - rect.y]);\n  },\n\n  /**\n   * @private\n   */\n  _getViewExtent: function _getViewExtent() {\n    return [0, this._size[0]];\n  },\n  _renderBackground: function _renderBackground() {\n    var dataZoomModel = this.dataZoomModel;\n    var size = this._size;\n    var barGroup = this._displayables.barGroup;\n    barGroup.add(new Rect({\n      silent: true,\n      shape: {\n        x: 0,\n        y: 0,\n        width: size[0],\n        height: size[1]\n      },\n      style: {\n        fill: dataZoomModel.get('backgroundColor')\n      },\n      z2: -40\n    })); // Click panel, over shadow, below handles.\n\n    barGroup.add(new Rect({\n      shape: {\n        x: 0,\n        y: 0,\n        width: size[0],\n        height: size[1]\n      },\n      style: {\n        fill: 'transparent'\n      },\n      z2: 0,\n      onclick: zrUtil.bind(this._onClickPanelClick, this)\n    }));\n  },\n  _renderDataShadow: function _renderDataShadow() {\n    var info = this._dataShadowInfo = this._prepareDataShadowInfo();\n\n    if (!info) {\n      return;\n    }\n\n    var size = this._size;\n    var seriesModel = info.series;\n    var data = seriesModel.getRawData();\n    var otherDim = seriesModel.getShadowDim ? seriesModel.getShadowDim() // @see candlestick\n    : info.otherDim;\n\n    if (otherDim == null) {\n      return;\n    }\n\n    var otherDataExtent = data.getDataExtent(otherDim); // Nice extent.\n\n    var otherOffset = (otherDataExtent[1] - otherDataExtent[0]) * 0.3;\n    otherDataExtent = [otherDataExtent[0] - otherOffset, otherDataExtent[1] + otherOffset];\n    var otherShadowExtent = [0, size[1]];\n    var thisShadowExtent = [0, size[0]];\n    var areaPoints = [[size[0], 0], [0, 0]];\n    var linePoints = [];\n    var step = thisShadowExtent[1] / (data.count() - 1);\n    var thisCoord = 0; // Optimize for large data shadow\n\n    var stride = Math.round(data.count() / size[0]);\n    var lastIsEmpty;\n    data.each([otherDim], function (value, index) {\n      if (stride > 0 && index % stride) {\n        thisCoord += step;\n        return;\n      } // FIXME\n      // Should consider axis.min/axis.max when drawing dataShadow.\n      // FIXME\n      // 应该使用统一的空判断？还是在list里进行空判断？\n\n\n      var isEmpty = value == null || isNaN(value) || value === ''; // See #4235.\n\n      var otherCoord = isEmpty ? 0 : linearMap(value, otherDataExtent, otherShadowExtent, true); // Attempt to draw data shadow precisely when there are empty value.\n\n      if (isEmpty && !lastIsEmpty && index) {\n        areaPoints.push([areaPoints[areaPoints.length - 1][0], 0]);\n        linePoints.push([linePoints[linePoints.length - 1][0], 0]);\n      } else if (!isEmpty && lastIsEmpty) {\n        areaPoints.push([thisCoord, 0]);\n        linePoints.push([thisCoord, 0]);\n      }\n\n      areaPoints.push([thisCoord, otherCoord]);\n      linePoints.push([thisCoord, otherCoord]);\n      thisCoord += step;\n      lastIsEmpty = isEmpty;\n    });\n    var dataZoomModel = this.dataZoomModel; // var dataBackgroundModel = dataZoomModel.getModel('dataBackground');\n\n    this._displayables.barGroup.add(new graphic.Polygon({\n      shape: {\n        points: areaPoints\n      },\n      style: zrUtil.defaults({\n        fill: dataZoomModel.get('dataBackgroundColor')\n      }, dataZoomModel.getModel('dataBackground.areaStyle').getAreaStyle()),\n      silent: true,\n      z2: -20\n    }));\n\n    this._displayables.barGroup.add(new graphic.Polyline({\n      shape: {\n        points: linePoints\n      },\n      style: dataZoomModel.getModel('dataBackground.lineStyle').getLineStyle(),\n      silent: true,\n      z2: -19\n    }));\n  },\n  _prepareDataShadowInfo: function _prepareDataShadowInfo() {\n    var dataZoomModel = this.dataZoomModel;\n    var showDataShadow = dataZoomModel.get('showDataShadow');\n\n    if (showDataShadow === false) {\n      return;\n    } // Find a representative series.\n\n\n    var result;\n    var ecModel = this.ecModel;\n    dataZoomModel.eachTargetAxis(function (dimNames, axisIndex) {\n      var seriesModels = dataZoomModel.getAxisProxy(dimNames.name, axisIndex).getTargetSeriesModels();\n      zrUtil.each(seriesModels, function (seriesModel) {\n        if (result) {\n          return;\n        }\n\n        if (showDataShadow !== true && zrUtil.indexOf(SHOW_DATA_SHADOW_SERIES_TYPE, seriesModel.get('type')) < 0) {\n          return;\n        }\n\n        var thisAxis = ecModel.getComponent(dimNames.axis, axisIndex).axis;\n        var otherDim = getOtherDim(dimNames.name);\n        var otherAxisInverse;\n        var coordSys = seriesModel.coordinateSystem;\n\n        if (otherDim != null && coordSys.getOtherAxis) {\n          otherAxisInverse = coordSys.getOtherAxis(thisAxis).inverse;\n        }\n\n        otherDim = seriesModel.getData().mapDimension(otherDim);\n        result = {\n          thisAxis: thisAxis,\n          series: seriesModel,\n          thisDim: dimNames.name,\n          otherDim: otherDim,\n          otherAxisInverse: otherAxisInverse\n        };\n      }, this);\n    }, this);\n    return result;\n  },\n  _renderHandle: function _renderHandle() {\n    var displaybles = this._displayables;\n    var handles = displaybles.handles = [];\n    var handleLabels = displaybles.handleLabels = [];\n    var barGroup = this._displayables.barGroup;\n    var size = this._size;\n    var dataZoomModel = this.dataZoomModel;\n    barGroup.add(displaybles.filler = new Rect({\n      draggable: true,\n      cursor: getCursor(this._orient),\n      drift: bind(this._onDragMove, this, 'all'),\n      ondragstart: bind(this._showDataInfo, this, true),\n      ondragend: bind(this._onDragEnd, this),\n      onmouseover: bind(this._showDataInfo, this, true),\n      onmouseout: bind(this._showDataInfo, this, false),\n      style: {\n        fill: dataZoomModel.get('fillerColor'),\n        textPosition: 'inside'\n      }\n    })); // Frame border.\n\n    barGroup.add(new Rect({\n      silent: true,\n      subPixelOptimize: true,\n      shape: {\n        x: 0,\n        y: 0,\n        width: size[0],\n        height: size[1]\n      },\n      style: {\n        stroke: dataZoomModel.get('dataBackgroundColor') || dataZoomModel.get('borderColor'),\n        lineWidth: DEFAULT_FRAME_BORDER_WIDTH,\n        fill: 'rgba(0,0,0,0)'\n      }\n    }));\n    each([0, 1], function (handleIndex) {\n      var path = graphic.createIcon(dataZoomModel.get('handleIcon'), {\n        cursor: getCursor(this._orient),\n        draggable: true,\n        drift: bind(this._onDragMove, this, handleIndex),\n        ondragend: bind(this._onDragEnd, this),\n        onmouseover: bind(this._showDataInfo, this, true),\n        onmouseout: bind(this._showDataInfo, this, false)\n      }, {\n        x: -1,\n        y: 0,\n        width: 2,\n        height: 2\n      });\n      var bRect = path.getBoundingRect();\n      this._handleHeight = numberUtil.parsePercent(dataZoomModel.get('handleSize'), this._size[1]);\n      this._handleWidth = bRect.width / bRect.height * this._handleHeight;\n      path.setStyle(dataZoomModel.getModel('handleStyle').getItemStyle());\n      var handleColor = dataZoomModel.get('handleColor'); // Compatitable with previous version\n\n      if (handleColor != null) {\n        path.style.fill = handleColor;\n      }\n\n      barGroup.add(handles[handleIndex] = path);\n      var textStyleModel = dataZoomModel.textStyleModel;\n      this.group.add(handleLabels[handleIndex] = new graphic.Text({\n        silent: true,\n        invisible: true,\n        style: {\n          x: 0,\n          y: 0,\n          text: '',\n          textVerticalAlign: 'middle',\n          textAlign: 'center',\n          textFill: textStyleModel.getTextColor(),\n          textFont: textStyleModel.getFont()\n        },\n        z2: 10\n      }));\n    }, this);\n  },\n\n  /**\n   * @private\n   */\n  _resetInterval: function _resetInterval() {\n    var range = this._range = this.dataZoomModel.getPercentRange();\n\n    var viewExtent = this._getViewExtent();\n\n    this._handleEnds = [linearMap(range[0], [0, 100], viewExtent, true), linearMap(range[1], [0, 100], viewExtent, true)];\n  },\n\n  /**\n   * @private\n   * @param {(number|string)} handleIndex 0 or 1 or 'all'\n   * @param {number} delta\n   * @return {boolean} changed\n   */\n  _updateInterval: function _updateInterval(handleIndex, delta) {\n    var dataZoomModel = this.dataZoomModel;\n    var handleEnds = this._handleEnds;\n\n    var viewExtend = this._getViewExtent();\n\n    var minMaxSpan = dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();\n    var percentExtent = [0, 100];\n    sliderMove(delta, handleEnds, viewExtend, dataZoomModel.get('zoomLock') ? 'all' : handleIndex, minMaxSpan.minSpan != null ? linearMap(minMaxSpan.minSpan, percentExtent, viewExtend, true) : null, minMaxSpan.maxSpan != null ? linearMap(minMaxSpan.maxSpan, percentExtent, viewExtend, true) : null);\n    var lastRange = this._range;\n    var range = this._range = asc([linearMap(handleEnds[0], viewExtend, percentExtent, true), linearMap(handleEnds[1], viewExtend, percentExtent, true)]);\n    return !lastRange || lastRange[0] !== range[0] || lastRange[1] !== range[1];\n  },\n\n  /**\n   * @private\n   */\n  _updateView: function _updateView(nonRealtime) {\n    var displaybles = this._displayables;\n    var handleEnds = this._handleEnds;\n    var handleInterval = asc(handleEnds.slice());\n    var size = this._size;\n    each([0, 1], function (handleIndex) {\n      // Handles\n      var handle = displaybles.handles[handleIndex];\n      var handleHeight = this._handleHeight;\n      handle.attr({\n        scale: [handleHeight / 2, handleHeight / 2],\n        position: [handleEnds[handleIndex], size[1] / 2 - handleHeight / 2]\n      });\n    }, this); // Filler\n\n    displaybles.filler.setShape({\n      x: handleInterval[0],\n      y: 0,\n      width: handleInterval[1] - handleInterval[0],\n      height: size[1]\n    });\n\n    this._updateDataInfo(nonRealtime);\n  },\n\n  /**\n   * @private\n   */\n  _updateDataInfo: function _updateDataInfo(nonRealtime) {\n    var dataZoomModel = this.dataZoomModel;\n    var displaybles = this._displayables;\n    var handleLabels = displaybles.handleLabels;\n    var orient = this._orient;\n    var labelTexts = ['', '']; // FIXME\n    // date型，支持formatter，autoformatter（ec2 date.getAutoFormatter）\n\n    if (dataZoomModel.get('showDetail')) {\n      var axisProxy = dataZoomModel.findRepresentativeAxisProxy();\n\n      if (axisProxy) {\n        var axis = axisProxy.getAxisModel().axis;\n        var range = this._range;\n        var dataInterval = nonRealtime // See #4434, data and axis are not processed and reset yet in non-realtime mode.\n        ? axisProxy.calculateDataWindow({\n          start: range[0],\n          end: range[1]\n        }).valueWindow : axisProxy.getDataValueWindow();\n        labelTexts = [this._formatLabel(dataInterval[0], axis), this._formatLabel(dataInterval[1], axis)];\n      }\n    }\n\n    var orderedHandleEnds = asc(this._handleEnds.slice());\n    setLabel.call(this, 0);\n    setLabel.call(this, 1);\n\n    function setLabel(handleIndex) {\n      // Label\n      // Text should not transform by barGroup.\n      // Ignore handlers transform\n      var barTransform = graphic.getTransform(displaybles.handles[handleIndex].parent, this.group);\n      var direction = graphic.transformDirection(handleIndex === 0 ? 'right' : 'left', barTransform);\n      var offset = this._handleWidth / 2 + LABEL_GAP;\n      var textPoint = graphic.applyTransform([orderedHandleEnds[handleIndex] + (handleIndex === 0 ? -offset : offset), this._size[1] / 2], barTransform);\n      handleLabels[handleIndex].setStyle({\n        x: textPoint[0],\n        y: textPoint[1],\n        textVerticalAlign: orient === HORIZONTAL ? 'middle' : direction,\n        textAlign: orient === HORIZONTAL ? direction : 'center',\n        text: labelTexts[handleIndex]\n      });\n    }\n  },\n\n  /**\n   * @private\n   */\n  _formatLabel: function _formatLabel(value, axis) {\n    var dataZoomModel = this.dataZoomModel;\n    var labelFormatter = dataZoomModel.get('labelFormatter');\n    var labelPrecision = dataZoomModel.get('labelPrecision');\n\n    if (labelPrecision == null || labelPrecision === 'auto') {\n      labelPrecision = axis.getPixelPrecision();\n    }\n\n    var valueStr = value == null || isNaN(value) ? '' // FIXME Glue code\n    : axis.type === 'category' || axis.type === 'time' ? axis.scale.getLabel(Math.round(value)) // param of toFixed should less then 20.\n    : value.toFixed(Math.min(labelPrecision, 20));\n    return zrUtil.isFunction(labelFormatter) ? labelFormatter(value, valueStr) : zrUtil.isString(labelFormatter) ? labelFormatter.replace('{value}', valueStr) : valueStr;\n  },\n\n  /**\n   * @private\n   * @param {boolean} showOrHide true: show, false: hide\n   */\n  _showDataInfo: function _showDataInfo(showOrHide) {\n    // Always show when drgging.\n    showOrHide = this._dragging || showOrHide;\n    var handleLabels = this._displayables.handleLabels;\n    handleLabels[0].attr('invisible', !showOrHide);\n    handleLabels[1].attr('invisible', !showOrHide);\n  },\n  _onDragMove: function _onDragMove(handleIndex, dx, dy, event) {\n    this._dragging = true; // For mobile device, prevent screen slider on the button.\n\n    eventTool.stop(event.event); // Transform dx, dy to bar coordination.\n\n    var barTransform = this._displayables.barGroup.getLocalTransform();\n\n    var vertex = graphic.applyTransform([dx, dy], barTransform, true);\n\n    var changed = this._updateInterval(handleIndex, vertex[0]);\n\n    var realtime = this.dataZoomModel.get('realtime');\n\n    this._updateView(!realtime); // Avoid dispatch dataZoom repeatly but range not changed,\n    // which cause bad visual effect when progressive enabled.\n\n\n    changed && realtime && this._dispatchZoomAction();\n  },\n  _onDragEnd: function _onDragEnd() {\n    this._dragging = false;\n\n    this._showDataInfo(false); // While in realtime mode and stream mode, dispatch action when\n    // drag end will cause the whole view rerender, which is unnecessary.\n\n\n    var realtime = this.dataZoomModel.get('realtime');\n    !realtime && this._dispatchZoomAction();\n  },\n  _onClickPanelClick: function _onClickPanelClick(e) {\n    var size = this._size;\n\n    var localPoint = this._displayables.barGroup.transformCoordToLocal(e.offsetX, e.offsetY);\n\n    if (localPoint[0] < 0 || localPoint[0] > size[0] || localPoint[1] < 0 || localPoint[1] > size[1]) {\n      return;\n    }\n\n    var handleEnds = this._handleEnds;\n    var center = (handleEnds[0] + handleEnds[1]) / 2;\n\n    var changed = this._updateInterval('all', localPoint[0] - center);\n\n    this._updateView();\n\n    changed && this._dispatchZoomAction();\n  },\n\n  /**\n   * This action will be throttled.\n   * @private\n   */\n  _dispatchZoomAction: function _dispatchZoomAction() {\n    var range = this._range;\n    this.api.dispatchAction({\n      type: 'dataZoom',\n      from: this.uid,\n      dataZoomId: this.dataZoomModel.id,\n      start: range[0],\n      end: range[1]\n    });\n  },\n\n  /**\n   * @private\n   */\n  _findCoordRect: function _findCoordRect() {\n    // Find the grid coresponding to the first axis referred by dataZoom.\n    var rect;\n    each(this.getTargetCoordInfo(), function (coordInfoList) {\n      if (!rect && coordInfoList.length) {\n        var coordSys = coordInfoList[0].model.coordinateSystem;\n        rect = coordSys.getRect && coordSys.getRect();\n      }\n    });\n\n    if (!rect) {\n      var width = this.api.getWidth();\n      var height = this.api.getHeight();\n      rect = {\n        x: width * 0.2,\n        y: height * 0.2,\n        width: width * 0.6,\n        height: height * 0.6\n      };\n    }\n\n    return rect;\n  }\n});\n\nfunction getOtherDim(thisDim) {\n  // FIXME\n  // 这个逻辑和getOtherAxis里一致，但是写在这里是否不好\n  var map = {\n    x: 'y',\n    y: 'x',\n    radius: 'angle',\n    angle: 'radius'\n  };\n  return map[thisDim];\n}\n\nfunction getCursor(orient) {\n  return orient === 'vertical' ? 'ns-resize' : 'ew-resize';\n}\n\nvar _default = SliderZoomView;\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/echarts/lib/component/dataZoom/SliderZoomView.js"],"names":["zrUtil","require","eventTool","graphic","throttle","DataZoomView","numberUtil","layout","sliderMove","Rect","linearMap","asc","bind","each","DEFAULT_LOCATION_EDGE_GAP","DEFAULT_FRAME_BORDER_WIDTH","DEFAULT_FILLER_SIZE","HORIZONTAL","VERTICAL","LABEL_GAP","SHOW_DATA_SHADOW_SERIES_TYPE","SliderZoomView","extend","type","init","ecModel","api","_displayables","_orient","_range","_handleEnds","_size","_handleWidth","_handleHeight","_location","_dragging","_dataShadowInfo","render","dataZoomModel","payload","superApply","arguments","createOrUpdate","get","group","removeAll","from","uid","_buildView","_updateView","remove","clear","dispose","thisGroup","_resetLocation","_resetInterval","barGroup","Group","_renderBackground","_renderHandle","_renderDataShadow","add","_positionGroup","coordRect","_findCoordRect","ecSize","width","getWidth","height","getHeight","positionInfo","right","x","top","y","layoutParams","getLayoutParams","option","name","layoutRect","getLayoutRect","padding","reverse","location","orient","targetAxisModel","getFirstTargetAxisModel","inverse","otherAxisInverse","attr","scale","rotation","Math","PI","rect","getBoundingRect","_getViewExtent","size","silent","shape","style","fill","z2","onclick","_onClickPanelClick","info","_prepareDataShadowInfo","seriesModel","series","data","getRawData","otherDim","getShadowDim","otherDataExtent","getDataExtent","otherOffset","otherShadowExtent","thisShadowExtent","areaPoints","linePoints","step","count","thisCoord","stride","round","lastIsEmpty","value","index","isEmpty","isNaN","otherCoord","push","length","Polygon","points","defaults","getModel","getAreaStyle","Polyline","getLineStyle","showDataShadow","result","eachTargetAxis","dimNames","axisIndex","seriesModels","getAxisProxy","getTargetSeriesModels","indexOf","thisAxis","getComponent","axis","getOtherDim","coordSys","coordinateSystem","getOtherAxis","getData","mapDimension","thisDim","displaybles","handles","handleLabels","filler","draggable","cursor","getCursor","drift","_onDragMove","ondragstart","_showDataInfo","ondragend","_onDragEnd","onmouseover","onmouseout","textPosition","subPixelOptimize","stroke","lineWidth","handleIndex","path","createIcon","bRect","parsePercent","setStyle","getItemStyle","handleColor","textStyleModel","Text","invisible","text","textVerticalAlign","textAlign","textFill","getTextColor","textFont","getFont","range","getPercentRange","viewExtent","_updateInterval","delta","handleEnds","viewExtend","minMaxSpan","findRepresentativeAxisProxy","getMinMaxSpan","percentExtent","minSpan","maxSpan","lastRange","nonRealtime","handleInterval","slice","handle","handleHeight","position","setShape","_updateDataInfo","labelTexts","axisProxy","getAxisModel","dataInterval","calculateDataWindow","start","end","valueWindow","getDataValueWindow","_formatLabel","orderedHandleEnds","setLabel","call","barTransform","getTransform","parent","direction","transformDirection","offset","textPoint","applyTransform","labelFormatter","labelPrecision","getPixelPrecision","valueStr","getLabel","toFixed","min","isFunction","isString","replace","showOrHide","dx","dy","event","stop","getLocalTransform","vertex","changed","realtime","_dispatchZoomAction","e","localPoint","transformCoordToLocal","offsetX","offsetY","center","dispatchAction","dataZoomId","id","getTargetCoordInfo","coordInfoList","model","getRect","map","radius","angle","_default","module","exports"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar eventTool = require(\"zrender/lib/core/event\");\n\nvar graphic = require(\"../../util/graphic\");\n\nvar throttle = require(\"../../util/throttle\");\n\nvar DataZoomView = require(\"./DataZoomView\");\n\nvar numberUtil = require(\"../../util/number\");\n\nvar layout = require(\"../../util/layout\");\n\nvar sliderMove = require(\"../helper/sliderMove\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar Rect = graphic.Rect;\nvar linearMap = numberUtil.linearMap;\nvar asc = numberUtil.asc;\nvar bind = zrUtil.bind;\nvar each = zrUtil.each; // Constants\n\nvar DEFAULT_LOCATION_EDGE_GAP = 7;\nvar DEFAULT_FRAME_BORDER_WIDTH = 1;\nvar DEFAULT_FILLER_SIZE = 30;\nvar HORIZONTAL = 'horizontal';\nvar VERTICAL = 'vertical';\nvar LABEL_GAP = 5;\nvar SHOW_DATA_SHADOW_SERIES_TYPE = ['line', 'bar', 'candlestick', 'scatter'];\nvar SliderZoomView = DataZoomView.extend({\n  type: 'dataZoom.slider',\n  init: function (ecModel, api) {\n    /**\n     * @private\n     * @type {Object}\n     */\n    this._displayables = {};\n    /**\n     * @private\n     * @type {string}\n     */\n\n    this._orient;\n    /**\n     * [0, 100]\n     * @private\n     */\n\n    this._range;\n    /**\n     * [coord of the first handle, coord of the second handle]\n     * @private\n     */\n\n    this._handleEnds;\n    /**\n     * [length, thick]\n     * @private\n     * @type {Array.<number>}\n     */\n\n    this._size;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    this._handleWidth;\n    /**\n     * @private\n     * @type {number}\n     */\n\n    this._handleHeight;\n    /**\n     * @private\n     */\n\n    this._location;\n    /**\n     * @private\n     */\n\n    this._dragging;\n    /**\n     * @private\n     */\n\n    this._dataShadowInfo;\n    this.api = api;\n  },\n\n  /**\n   * @override\n   */\n  render: function (dataZoomModel, ecModel, api, payload) {\n    SliderZoomView.superApply(this, 'render', arguments);\n    throttle.createOrUpdate(this, '_dispatchZoomAction', this.dataZoomModel.get('throttle'), 'fixRate');\n    this._orient = dataZoomModel.get('orient');\n\n    if (this.dataZoomModel.get('show') === false) {\n      this.group.removeAll();\n      return;\n    } // Notice: this._resetInterval() should not be executed when payload.type\n    // is 'dataZoom', origin this._range should be maintained, otherwise 'pan'\n    // or 'zoom' info will be missed because of 'throttle' of this.dispatchAction,\n\n\n    if (!payload || payload.type !== 'dataZoom' || payload.from !== this.uid) {\n      this._buildView();\n    }\n\n    this._updateView();\n  },\n\n  /**\n   * @override\n   */\n  remove: function () {\n    SliderZoomView.superApply(this, 'remove', arguments);\n    throttle.clear(this, '_dispatchZoomAction');\n  },\n\n  /**\n   * @override\n   */\n  dispose: function () {\n    SliderZoomView.superApply(this, 'dispose', arguments);\n    throttle.clear(this, '_dispatchZoomAction');\n  },\n  _buildView: function () {\n    var thisGroup = this.group;\n    thisGroup.removeAll();\n\n    this._resetLocation();\n\n    this._resetInterval();\n\n    var barGroup = this._displayables.barGroup = new graphic.Group();\n\n    this._renderBackground();\n\n    this._renderHandle();\n\n    this._renderDataShadow();\n\n    thisGroup.add(barGroup);\n\n    this._positionGroup();\n  },\n\n  /**\n   * @private\n   */\n  _resetLocation: function () {\n    var dataZoomModel = this.dataZoomModel;\n    var api = this.api; // If some of x/y/width/height are not specified,\n    // auto-adapt according to target grid.\n\n    var coordRect = this._findCoordRect();\n\n    var ecSize = {\n      width: api.getWidth(),\n      height: api.getHeight()\n    }; // Default align by coordinate system rect.\n\n    var positionInfo = this._orient === HORIZONTAL ? {\n      // Why using 'right', because right should be used in vertical,\n      // and it is better to be consistent for dealing with position param merge.\n      right: ecSize.width - coordRect.x - coordRect.width,\n      top: ecSize.height - DEFAULT_FILLER_SIZE - DEFAULT_LOCATION_EDGE_GAP,\n      width: coordRect.width,\n      height: DEFAULT_FILLER_SIZE\n    } : {\n      // vertical\n      right: DEFAULT_LOCATION_EDGE_GAP,\n      top: coordRect.y,\n      width: DEFAULT_FILLER_SIZE,\n      height: coordRect.height\n    }; // Do not write back to option and replace value 'ph', because\n    // the 'ph' value should be recalculated when resize.\n\n    var layoutParams = layout.getLayoutParams(dataZoomModel.option); // Replace the placeholder value.\n\n    zrUtil.each(['right', 'top', 'width', 'height'], function (name) {\n      if (layoutParams[name] === 'ph') {\n        layoutParams[name] = positionInfo[name];\n      }\n    });\n    var layoutRect = layout.getLayoutRect(layoutParams, ecSize, dataZoomModel.padding);\n    this._location = {\n      x: layoutRect.x,\n      y: layoutRect.y\n    };\n    this._size = [layoutRect.width, layoutRect.height];\n    this._orient === VERTICAL && this._size.reverse();\n  },\n\n  /**\n   * @private\n   */\n  _positionGroup: function () {\n    var thisGroup = this.group;\n    var location = this._location;\n    var orient = this._orient; // Just use the first axis to determine mapping.\n\n    var targetAxisModel = this.dataZoomModel.getFirstTargetAxisModel();\n    var inverse = targetAxisModel && targetAxisModel.get('inverse');\n    var barGroup = this._displayables.barGroup;\n    var otherAxisInverse = (this._dataShadowInfo || {}).otherAxisInverse; // Transform barGroup.\n\n    barGroup.attr(orient === HORIZONTAL && !inverse ? {\n      scale: otherAxisInverse ? [1, 1] : [1, -1]\n    } : orient === HORIZONTAL && inverse ? {\n      scale: otherAxisInverse ? [-1, 1] : [-1, -1]\n    } : orient === VERTICAL && !inverse ? {\n      scale: otherAxisInverse ? [1, -1] : [1, 1],\n      rotation: Math.PI / 2 // Dont use Math.PI, considering shadow direction.\n\n    } : {\n      scale: otherAxisInverse ? [-1, -1] : [-1, 1],\n      rotation: Math.PI / 2\n    }); // Position barGroup\n\n    var rect = thisGroup.getBoundingRect([barGroup]);\n    thisGroup.attr('position', [location.x - rect.x, location.y - rect.y]);\n  },\n\n  /**\n   * @private\n   */\n  _getViewExtent: function () {\n    return [0, this._size[0]];\n  },\n  _renderBackground: function () {\n    var dataZoomModel = this.dataZoomModel;\n    var size = this._size;\n    var barGroup = this._displayables.barGroup;\n    barGroup.add(new Rect({\n      silent: true,\n      shape: {\n        x: 0,\n        y: 0,\n        width: size[0],\n        height: size[1]\n      },\n      style: {\n        fill: dataZoomModel.get('backgroundColor')\n      },\n      z2: -40\n    })); // Click panel, over shadow, below handles.\n\n    barGroup.add(new Rect({\n      shape: {\n        x: 0,\n        y: 0,\n        width: size[0],\n        height: size[1]\n      },\n      style: {\n        fill: 'transparent'\n      },\n      z2: 0,\n      onclick: zrUtil.bind(this._onClickPanelClick, this)\n    }));\n  },\n  _renderDataShadow: function () {\n    var info = this._dataShadowInfo = this._prepareDataShadowInfo();\n\n    if (!info) {\n      return;\n    }\n\n    var size = this._size;\n    var seriesModel = info.series;\n    var data = seriesModel.getRawData();\n    var otherDim = seriesModel.getShadowDim ? seriesModel.getShadowDim() // @see candlestick\n    : info.otherDim;\n\n    if (otherDim == null) {\n      return;\n    }\n\n    var otherDataExtent = data.getDataExtent(otherDim); // Nice extent.\n\n    var otherOffset = (otherDataExtent[1] - otherDataExtent[0]) * 0.3;\n    otherDataExtent = [otherDataExtent[0] - otherOffset, otherDataExtent[1] + otherOffset];\n    var otherShadowExtent = [0, size[1]];\n    var thisShadowExtent = [0, size[0]];\n    var areaPoints = [[size[0], 0], [0, 0]];\n    var linePoints = [];\n    var step = thisShadowExtent[1] / (data.count() - 1);\n    var thisCoord = 0; // Optimize for large data shadow\n\n    var stride = Math.round(data.count() / size[0]);\n    var lastIsEmpty;\n    data.each([otherDim], function (value, index) {\n      if (stride > 0 && index % stride) {\n        thisCoord += step;\n        return;\n      } // FIXME\n      // Should consider axis.min/axis.max when drawing dataShadow.\n      // FIXME\n      // 应该使用统一的空判断？还是在list里进行空判断？\n\n\n      var isEmpty = value == null || isNaN(value) || value === ''; // See #4235.\n\n      var otherCoord = isEmpty ? 0 : linearMap(value, otherDataExtent, otherShadowExtent, true); // Attempt to draw data shadow precisely when there are empty value.\n\n      if (isEmpty && !lastIsEmpty && index) {\n        areaPoints.push([areaPoints[areaPoints.length - 1][0], 0]);\n        linePoints.push([linePoints[linePoints.length - 1][0], 0]);\n      } else if (!isEmpty && lastIsEmpty) {\n        areaPoints.push([thisCoord, 0]);\n        linePoints.push([thisCoord, 0]);\n      }\n\n      areaPoints.push([thisCoord, otherCoord]);\n      linePoints.push([thisCoord, otherCoord]);\n      thisCoord += step;\n      lastIsEmpty = isEmpty;\n    });\n    var dataZoomModel = this.dataZoomModel; // var dataBackgroundModel = dataZoomModel.getModel('dataBackground');\n\n    this._displayables.barGroup.add(new graphic.Polygon({\n      shape: {\n        points: areaPoints\n      },\n      style: zrUtil.defaults({\n        fill: dataZoomModel.get('dataBackgroundColor')\n      }, dataZoomModel.getModel('dataBackground.areaStyle').getAreaStyle()),\n      silent: true,\n      z2: -20\n    }));\n\n    this._displayables.barGroup.add(new graphic.Polyline({\n      shape: {\n        points: linePoints\n      },\n      style: dataZoomModel.getModel('dataBackground.lineStyle').getLineStyle(),\n      silent: true,\n      z2: -19\n    }));\n  },\n  _prepareDataShadowInfo: function () {\n    var dataZoomModel = this.dataZoomModel;\n    var showDataShadow = dataZoomModel.get('showDataShadow');\n\n    if (showDataShadow === false) {\n      return;\n    } // Find a representative series.\n\n\n    var result;\n    var ecModel = this.ecModel;\n    dataZoomModel.eachTargetAxis(function (dimNames, axisIndex) {\n      var seriesModels = dataZoomModel.getAxisProxy(dimNames.name, axisIndex).getTargetSeriesModels();\n      zrUtil.each(seriesModels, function (seriesModel) {\n        if (result) {\n          return;\n        }\n\n        if (showDataShadow !== true && zrUtil.indexOf(SHOW_DATA_SHADOW_SERIES_TYPE, seriesModel.get('type')) < 0) {\n          return;\n        }\n\n        var thisAxis = ecModel.getComponent(dimNames.axis, axisIndex).axis;\n        var otherDim = getOtherDim(dimNames.name);\n        var otherAxisInverse;\n        var coordSys = seriesModel.coordinateSystem;\n\n        if (otherDim != null && coordSys.getOtherAxis) {\n          otherAxisInverse = coordSys.getOtherAxis(thisAxis).inverse;\n        }\n\n        otherDim = seriesModel.getData().mapDimension(otherDim);\n        result = {\n          thisAxis: thisAxis,\n          series: seriesModel,\n          thisDim: dimNames.name,\n          otherDim: otherDim,\n          otherAxisInverse: otherAxisInverse\n        };\n      }, this);\n    }, this);\n    return result;\n  },\n  _renderHandle: function () {\n    var displaybles = this._displayables;\n    var handles = displaybles.handles = [];\n    var handleLabels = displaybles.handleLabels = [];\n    var barGroup = this._displayables.barGroup;\n    var size = this._size;\n    var dataZoomModel = this.dataZoomModel;\n    barGroup.add(displaybles.filler = new Rect({\n      draggable: true,\n      cursor: getCursor(this._orient),\n      drift: bind(this._onDragMove, this, 'all'),\n      ondragstart: bind(this._showDataInfo, this, true),\n      ondragend: bind(this._onDragEnd, this),\n      onmouseover: bind(this._showDataInfo, this, true),\n      onmouseout: bind(this._showDataInfo, this, false),\n      style: {\n        fill: dataZoomModel.get('fillerColor'),\n        textPosition: 'inside'\n      }\n    })); // Frame border.\n\n    barGroup.add(new Rect({\n      silent: true,\n      subPixelOptimize: true,\n      shape: {\n        x: 0,\n        y: 0,\n        width: size[0],\n        height: size[1]\n      },\n      style: {\n        stroke: dataZoomModel.get('dataBackgroundColor') || dataZoomModel.get('borderColor'),\n        lineWidth: DEFAULT_FRAME_BORDER_WIDTH,\n        fill: 'rgba(0,0,0,0)'\n      }\n    }));\n    each([0, 1], function (handleIndex) {\n      var path = graphic.createIcon(dataZoomModel.get('handleIcon'), {\n        cursor: getCursor(this._orient),\n        draggable: true,\n        drift: bind(this._onDragMove, this, handleIndex),\n        ondragend: bind(this._onDragEnd, this),\n        onmouseover: bind(this._showDataInfo, this, true),\n        onmouseout: bind(this._showDataInfo, this, false)\n      }, {\n        x: -1,\n        y: 0,\n        width: 2,\n        height: 2\n      });\n      var bRect = path.getBoundingRect();\n      this._handleHeight = numberUtil.parsePercent(dataZoomModel.get('handleSize'), this._size[1]);\n      this._handleWidth = bRect.width / bRect.height * this._handleHeight;\n      path.setStyle(dataZoomModel.getModel('handleStyle').getItemStyle());\n      var handleColor = dataZoomModel.get('handleColor'); // Compatitable with previous version\n\n      if (handleColor != null) {\n        path.style.fill = handleColor;\n      }\n\n      barGroup.add(handles[handleIndex] = path);\n      var textStyleModel = dataZoomModel.textStyleModel;\n      this.group.add(handleLabels[handleIndex] = new graphic.Text({\n        silent: true,\n        invisible: true,\n        style: {\n          x: 0,\n          y: 0,\n          text: '',\n          textVerticalAlign: 'middle',\n          textAlign: 'center',\n          textFill: textStyleModel.getTextColor(),\n          textFont: textStyleModel.getFont()\n        },\n        z2: 10\n      }));\n    }, this);\n  },\n\n  /**\n   * @private\n   */\n  _resetInterval: function () {\n    var range = this._range = this.dataZoomModel.getPercentRange();\n\n    var viewExtent = this._getViewExtent();\n\n    this._handleEnds = [linearMap(range[0], [0, 100], viewExtent, true), linearMap(range[1], [0, 100], viewExtent, true)];\n  },\n\n  /**\n   * @private\n   * @param {(number|string)} handleIndex 0 or 1 or 'all'\n   * @param {number} delta\n   * @return {boolean} changed\n   */\n  _updateInterval: function (handleIndex, delta) {\n    var dataZoomModel = this.dataZoomModel;\n    var handleEnds = this._handleEnds;\n\n    var viewExtend = this._getViewExtent();\n\n    var minMaxSpan = dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();\n    var percentExtent = [0, 100];\n    sliderMove(delta, handleEnds, viewExtend, dataZoomModel.get('zoomLock') ? 'all' : handleIndex, minMaxSpan.minSpan != null ? linearMap(minMaxSpan.minSpan, percentExtent, viewExtend, true) : null, minMaxSpan.maxSpan != null ? linearMap(minMaxSpan.maxSpan, percentExtent, viewExtend, true) : null);\n    var lastRange = this._range;\n    var range = this._range = asc([linearMap(handleEnds[0], viewExtend, percentExtent, true), linearMap(handleEnds[1], viewExtend, percentExtent, true)]);\n    return !lastRange || lastRange[0] !== range[0] || lastRange[1] !== range[1];\n  },\n\n  /**\n   * @private\n   */\n  _updateView: function (nonRealtime) {\n    var displaybles = this._displayables;\n    var handleEnds = this._handleEnds;\n    var handleInterval = asc(handleEnds.slice());\n    var size = this._size;\n    each([0, 1], function (handleIndex) {\n      // Handles\n      var handle = displaybles.handles[handleIndex];\n      var handleHeight = this._handleHeight;\n      handle.attr({\n        scale: [handleHeight / 2, handleHeight / 2],\n        position: [handleEnds[handleIndex], size[1] / 2 - handleHeight / 2]\n      });\n    }, this); // Filler\n\n    displaybles.filler.setShape({\n      x: handleInterval[0],\n      y: 0,\n      width: handleInterval[1] - handleInterval[0],\n      height: size[1]\n    });\n\n    this._updateDataInfo(nonRealtime);\n  },\n\n  /**\n   * @private\n   */\n  _updateDataInfo: function (nonRealtime) {\n    var dataZoomModel = this.dataZoomModel;\n    var displaybles = this._displayables;\n    var handleLabels = displaybles.handleLabels;\n    var orient = this._orient;\n    var labelTexts = ['', '']; // FIXME\n    // date型，支持formatter，autoformatter（ec2 date.getAutoFormatter）\n\n    if (dataZoomModel.get('showDetail')) {\n      var axisProxy = dataZoomModel.findRepresentativeAxisProxy();\n\n      if (axisProxy) {\n        var axis = axisProxy.getAxisModel().axis;\n        var range = this._range;\n        var dataInterval = nonRealtime // See #4434, data and axis are not processed and reset yet in non-realtime mode.\n        ? axisProxy.calculateDataWindow({\n          start: range[0],\n          end: range[1]\n        }).valueWindow : axisProxy.getDataValueWindow();\n        labelTexts = [this._formatLabel(dataInterval[0], axis), this._formatLabel(dataInterval[1], axis)];\n      }\n    }\n\n    var orderedHandleEnds = asc(this._handleEnds.slice());\n    setLabel.call(this, 0);\n    setLabel.call(this, 1);\n\n    function setLabel(handleIndex) {\n      // Label\n      // Text should not transform by barGroup.\n      // Ignore handlers transform\n      var barTransform = graphic.getTransform(displaybles.handles[handleIndex].parent, this.group);\n      var direction = graphic.transformDirection(handleIndex === 0 ? 'right' : 'left', barTransform);\n      var offset = this._handleWidth / 2 + LABEL_GAP;\n      var textPoint = graphic.applyTransform([orderedHandleEnds[handleIndex] + (handleIndex === 0 ? -offset : offset), this._size[1] / 2], barTransform);\n      handleLabels[handleIndex].setStyle({\n        x: textPoint[0],\n        y: textPoint[1],\n        textVerticalAlign: orient === HORIZONTAL ? 'middle' : direction,\n        textAlign: orient === HORIZONTAL ? direction : 'center',\n        text: labelTexts[handleIndex]\n      });\n    }\n  },\n\n  /**\n   * @private\n   */\n  _formatLabel: function (value, axis) {\n    var dataZoomModel = this.dataZoomModel;\n    var labelFormatter = dataZoomModel.get('labelFormatter');\n    var labelPrecision = dataZoomModel.get('labelPrecision');\n\n    if (labelPrecision == null || labelPrecision === 'auto') {\n      labelPrecision = axis.getPixelPrecision();\n    }\n\n    var valueStr = value == null || isNaN(value) ? '' // FIXME Glue code\n    : axis.type === 'category' || axis.type === 'time' ? axis.scale.getLabel(Math.round(value)) // param of toFixed should less then 20.\n    : value.toFixed(Math.min(labelPrecision, 20));\n    return zrUtil.isFunction(labelFormatter) ? labelFormatter(value, valueStr) : zrUtil.isString(labelFormatter) ? labelFormatter.replace('{value}', valueStr) : valueStr;\n  },\n\n  /**\n   * @private\n   * @param {boolean} showOrHide true: show, false: hide\n   */\n  _showDataInfo: function (showOrHide) {\n    // Always show when drgging.\n    showOrHide = this._dragging || showOrHide;\n    var handleLabels = this._displayables.handleLabels;\n    handleLabels[0].attr('invisible', !showOrHide);\n    handleLabels[1].attr('invisible', !showOrHide);\n  },\n  _onDragMove: function (handleIndex, dx, dy, event) {\n    this._dragging = true; // For mobile device, prevent screen slider on the button.\n\n    eventTool.stop(event.event); // Transform dx, dy to bar coordination.\n\n    var barTransform = this._displayables.barGroup.getLocalTransform();\n\n    var vertex = graphic.applyTransform([dx, dy], barTransform, true);\n\n    var changed = this._updateInterval(handleIndex, vertex[0]);\n\n    var realtime = this.dataZoomModel.get('realtime');\n\n    this._updateView(!realtime); // Avoid dispatch dataZoom repeatly but range not changed,\n    // which cause bad visual effect when progressive enabled.\n\n\n    changed && realtime && this._dispatchZoomAction();\n  },\n  _onDragEnd: function () {\n    this._dragging = false;\n\n    this._showDataInfo(false); // While in realtime mode and stream mode, dispatch action when\n    // drag end will cause the whole view rerender, which is unnecessary.\n\n\n    var realtime = this.dataZoomModel.get('realtime');\n    !realtime && this._dispatchZoomAction();\n  },\n  _onClickPanelClick: function (e) {\n    var size = this._size;\n\n    var localPoint = this._displayables.barGroup.transformCoordToLocal(e.offsetX, e.offsetY);\n\n    if (localPoint[0] < 0 || localPoint[0] > size[0] || localPoint[1] < 0 || localPoint[1] > size[1]) {\n      return;\n    }\n\n    var handleEnds = this._handleEnds;\n    var center = (handleEnds[0] + handleEnds[1]) / 2;\n\n    var changed = this._updateInterval('all', localPoint[0] - center);\n\n    this._updateView();\n\n    changed && this._dispatchZoomAction();\n  },\n\n  /**\n   * This action will be throttled.\n   * @private\n   */\n  _dispatchZoomAction: function () {\n    var range = this._range;\n    this.api.dispatchAction({\n      type: 'dataZoom',\n      from: this.uid,\n      dataZoomId: this.dataZoomModel.id,\n      start: range[0],\n      end: range[1]\n    });\n  },\n\n  /**\n   * @private\n   */\n  _findCoordRect: function () {\n    // Find the grid coresponding to the first axis referred by dataZoom.\n    var rect;\n    each(this.getTargetCoordInfo(), function (coordInfoList) {\n      if (!rect && coordInfoList.length) {\n        var coordSys = coordInfoList[0].model.coordinateSystem;\n        rect = coordSys.getRect && coordSys.getRect();\n      }\n    });\n\n    if (!rect) {\n      var width = this.api.getWidth();\n      var height = this.api.getHeight();\n      rect = {\n        x: width * 0.2,\n        y: height * 0.2,\n        width: width * 0.6,\n        height: height * 0.6\n      };\n    }\n\n    return rect;\n  }\n});\n\nfunction getOtherDim(thisDim) {\n  // FIXME\n  // 这个逻辑和getOtherAxis里一致，但是写在这里是否不好\n  var map = {\n    x: 'y',\n    y: 'x',\n    radius: 'angle',\n    angle: 'radius'\n  };\n  return map[thisDim];\n}\n\nfunction getCursor(orient) {\n  return orient === 'vertical' ? 'ns-resize' : 'ew-resize';\n}\n\nvar _default = SliderZoomView;\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}