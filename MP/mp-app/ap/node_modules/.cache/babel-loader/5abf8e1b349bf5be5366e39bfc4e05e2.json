{"ast":null,"code":"/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar _config = require(\"../../config\");\n\nvar __DEV__ = _config.__DEV__;\n\nvar SeriesModel = require(\"../../model/Series\");\n\nvar List = require(\"../../data/List\");\n\nvar _util = require(\"zrender/lib/core/util\");\n\nvar concatArray = _util.concatArray;\nvar mergeAll = _util.mergeAll;\nvar map = _util.map;\n\nvar _format = require(\"../../util/format\");\n\nvar encodeHTML = _format.encodeHTML;\n\nvar CoordinateSystem = require(\"../../CoordinateSystem\");\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/* global Uint32Array, Float64Array, Float32Array */\n\n\nvar Uint32Arr = typeof Uint32Array === 'undefined' ? Array : Uint32Array;\nvar Float64Arr = typeof Float64Array === 'undefined' ? Array : Float64Array;\n\nfunction compatEc2(seriesOpt) {\n  var data = seriesOpt.data;\n\n  if (data && data[0] && data[0][0] && data[0][0].coord) {\n    seriesOpt.data = map(data, function (itemOpt) {\n      var coords = [itemOpt[0].coord, itemOpt[1].coord];\n      var target = {\n        coords: coords\n      };\n\n      if (itemOpt[0].name) {\n        target.fromName = itemOpt[0].name;\n      }\n\n      if (itemOpt[1].name) {\n        target.toName = itemOpt[1].name;\n      }\n\n      return mergeAll([target, itemOpt[0], itemOpt[1]]);\n    });\n  }\n}\n\nvar LinesSeries = SeriesModel.extend({\n  type: 'series.lines',\n  dependencies: ['grid', 'polar'],\n  visualColorAccessPath: 'lineStyle.color',\n  init: function init(option) {\n    // The input data may be null/undefined.\n    option.data = option.data || []; // Not using preprocessor because mergeOption may not have series.type\n\n    compatEc2(option);\n\n    var result = this._processFlatCoordsArray(option.data);\n\n    this._flatCoords = result.flatCoords;\n    this._flatCoordsOffset = result.flatCoordsOffset;\n\n    if (result.flatCoords) {\n      option.data = new Float32Array(result.count);\n    }\n\n    LinesSeries.superApply(this, 'init', arguments);\n  },\n  mergeOption: function mergeOption(option) {\n    compatEc2(option);\n\n    if (option.data) {\n      // Only update when have option data to merge.\n      var result = this._processFlatCoordsArray(option.data);\n\n      this._flatCoords = result.flatCoords;\n      this._flatCoordsOffset = result.flatCoordsOffset;\n\n      if (result.flatCoords) {\n        option.data = new Float32Array(result.count);\n      }\n    }\n\n    LinesSeries.superApply(this, 'mergeOption', arguments);\n  },\n  appendData: function appendData(params) {\n    var result = this._processFlatCoordsArray(params.data);\n\n    if (result.flatCoords) {\n      if (!this._flatCoords) {\n        this._flatCoords = result.flatCoords;\n        this._flatCoordsOffset = result.flatCoordsOffset;\n      } else {\n        this._flatCoords = concatArray(this._flatCoords, result.flatCoords);\n        this._flatCoordsOffset = concatArray(this._flatCoordsOffset, result.flatCoordsOffset);\n      }\n\n      params.data = new Float32Array(result.count);\n    }\n\n    this.getRawData().appendData(params.data);\n  },\n  _getCoordsFromItemModel: function _getCoordsFromItemModel(idx) {\n    var itemModel = this.getData().getItemModel(idx);\n    var coords = itemModel.option instanceof Array ? itemModel.option : itemModel.getShallow('coords');\n    return coords;\n  },\n  getLineCoordsCount: function getLineCoordsCount(idx) {\n    if (this._flatCoordsOffset) {\n      return this._flatCoordsOffset[idx * 2 + 1];\n    } else {\n      return this._getCoordsFromItemModel(idx).length;\n    }\n  },\n  getLineCoords: function getLineCoords(idx, out) {\n    if (this._flatCoordsOffset) {\n      var offset = this._flatCoordsOffset[idx * 2];\n      var len = this._flatCoordsOffset[idx * 2 + 1];\n\n      for (var i = 0; i < len; i++) {\n        out[i] = out[i] || [];\n        out[i][0] = this._flatCoords[offset + i * 2];\n        out[i][1] = this._flatCoords[offset + i * 2 + 1];\n      }\n\n      return len;\n    } else {\n      var coords = this._getCoordsFromItemModel(idx);\n\n      for (var i = 0; i < coords.length; i++) {\n        out[i] = out[i] || [];\n        out[i][0] = coords[i][0];\n        out[i][1] = coords[i][1];\n      }\n\n      return coords.length;\n    }\n  },\n  _processFlatCoordsArray: function _processFlatCoordsArray(data) {\n    var startOffset = 0;\n\n    if (this._flatCoords) {\n      startOffset = this._flatCoords.length;\n    } // Stored as a typed array. In format\n    // Points Count(2) | x | y | x | y | Points Count(3) | x |  y | x | y | x | y |\n\n\n    if (typeof data[0] === 'number') {\n      var len = data.length; // Store offset and len of each segment\n\n      var coordsOffsetAndLenStorage = new Uint32Arr(len);\n      var coordsStorage = new Float64Arr(len);\n      var coordsCursor = 0;\n      var offsetCursor = 0;\n      var dataCount = 0;\n\n      for (var i = 0; i < len;) {\n        dataCount++;\n        var count = data[i++]; // Offset\n\n        coordsOffsetAndLenStorage[offsetCursor++] = coordsCursor + startOffset; // Len\n\n        coordsOffsetAndLenStorage[offsetCursor++] = count;\n\n        for (var k = 0; k < count; k++) {\n          var x = data[i++];\n          var y = data[i++];\n          coordsStorage[coordsCursor++] = x;\n          coordsStorage[coordsCursor++] = y;\n\n          if (i > len) {}\n        }\n      }\n\n      return {\n        flatCoordsOffset: new Uint32Array(coordsOffsetAndLenStorage.buffer, 0, offsetCursor),\n        flatCoords: coordsStorage,\n        count: dataCount\n      };\n    }\n\n    return {\n      flatCoordsOffset: null,\n      flatCoords: null,\n      count: data.length\n    };\n  },\n  getInitialData: function getInitialData(option, ecModel) {\n    var lineData = new List(['value'], this);\n    lineData.hasItemOption = false;\n    lineData.initData(option.data, [], function (dataItem, dimName, dataIndex, dimIndex) {\n      // dataItem is simply coords\n      if (dataItem instanceof Array) {\n        return NaN;\n      } else {\n        lineData.hasItemOption = true;\n        var value = dataItem.value;\n\n        if (value != null) {\n          return value instanceof Array ? value[dimIndex] : value;\n        }\n      }\n    });\n    return lineData;\n  },\n  formatTooltip: function formatTooltip(dataIndex) {\n    var data = this.getData();\n    var itemModel = data.getItemModel(dataIndex);\n    var name = itemModel.get('name');\n\n    if (name) {\n      return name;\n    }\n\n    var fromName = itemModel.get('fromName');\n    var toName = itemModel.get('toName');\n    var html = [];\n    fromName != null && html.push(fromName);\n    toName != null && html.push(toName);\n    return encodeHTML(html.join(' > '));\n  },\n  preventIncremental: function preventIncremental() {\n    return !!this.get('effect.show');\n  },\n  getProgressive: function getProgressive() {\n    var progressive = this.option.progressive;\n\n    if (progressive == null) {\n      return this.option.large ? 1e4 : this.get('progressive');\n    }\n\n    return progressive;\n  },\n  getProgressiveThreshold: function getProgressiveThreshold() {\n    var progressiveThreshold = this.option.progressiveThreshold;\n\n    if (progressiveThreshold == null) {\n      return this.option.large ? 2e4 : this.get('progressiveThreshold');\n    }\n\n    return progressiveThreshold;\n  },\n  defaultOption: {\n    coordinateSystem: 'geo',\n    zlevel: 0,\n    z: 2,\n    legendHoverLink: true,\n    hoverAnimation: true,\n    // Cartesian coordinate system\n    xAxisIndex: 0,\n    yAxisIndex: 0,\n    symbol: ['none', 'none'],\n    symbolSize: [10, 10],\n    // Geo coordinate system\n    geoIndex: 0,\n    effect: {\n      show: false,\n      period: 4,\n      // Animation delay. support callback\n      // delay: 0,\n      // If move with constant speed px/sec\n      // period will be ignored if this property is > 0,\n      constantSpeed: 0,\n      symbol: 'circle',\n      symbolSize: 3,\n      loop: true,\n      // Length of trail, 0 - 1\n      trailLength: 0.2 // Same with lineStyle.color\n      // color\n\n    },\n    large: false,\n    // Available when large is true\n    largeThreshold: 2000,\n    // If lines are polyline\n    // polyline not support curveness, label, animation\n    polyline: false,\n    // If clip the overflow.\n    // Available when coordinateSystem is cartesian or polar.\n    clip: true,\n    label: {\n      show: false,\n      position: 'end' // distance: 5,\n      // formatter: 标签文本格式器，同Tooltip.formatter，不支持异步回调\n\n    },\n    lineStyle: {\n      opacity: 0.5\n    }\n  }\n});\nvar _default = LinesSeries;\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/echarts/lib/chart/lines/LinesSeries.js"],"names":["_config","require","__DEV__","SeriesModel","List","_util","concatArray","mergeAll","map","_format","encodeHTML","CoordinateSystem","Uint32Arr","Uint32Array","Array","Float64Arr","Float64Array","compatEc2","seriesOpt","data","coord","itemOpt","coords","target","name","fromName","toName","LinesSeries","extend","type","dependencies","visualColorAccessPath","init","option","result","_processFlatCoordsArray","_flatCoords","flatCoords","_flatCoordsOffset","flatCoordsOffset","Float32Array","count","superApply","arguments","mergeOption","appendData","params","getRawData","_getCoordsFromItemModel","idx","itemModel","getData","getItemModel","getShallow","getLineCoordsCount","length","getLineCoords","out","offset","len","i","startOffset","coordsOffsetAndLenStorage","coordsStorage","coordsCursor","offsetCursor","dataCount","k","x","y","buffer","getInitialData","ecModel","lineData","hasItemOption","initData","dataItem","dimName","dataIndex","dimIndex","NaN","value","formatTooltip","get","html","push","join","preventIncremental","getProgressive","progressive","large","getProgressiveThreshold","progressiveThreshold","defaultOption","coordinateSystem","zlevel","z","legendHoverLink","hoverAnimation","xAxisIndex","yAxisIndex","symbol","symbolSize","geoIndex","effect","show","period","constantSpeed","loop","trailLength","largeThreshold","polyline","clip","label","position","lineStyle","opacity","_default","module","exports"],"mappings":"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","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _config = require(\"../../config\");\n\nvar __DEV__ = _config.__DEV__;\n\nvar SeriesModel = require(\"../../model/Series\");\n\nvar List = require(\"../../data/List\");\n\nvar _util = require(\"zrender/lib/core/util\");\n\nvar concatArray = _util.concatArray;\nvar mergeAll = _util.mergeAll;\nvar map = _util.map;\n\nvar _format = require(\"../../util/format\");\n\nvar encodeHTML = _format.encodeHTML;\n\nvar CoordinateSystem = require(\"../../CoordinateSystem\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/* global Uint32Array, Float64Array, Float32Array */\nvar Uint32Arr = typeof Uint32Array === 'undefined' ? Array : Uint32Array;\nvar Float64Arr = typeof Float64Array === 'undefined' ? Array : Float64Array;\n\nfunction compatEc2(seriesOpt) {\n  var data = seriesOpt.data;\n\n  if (data && data[0] && data[0][0] && data[0][0].coord) {\n    seriesOpt.data = map(data, function (itemOpt) {\n      var coords = [itemOpt[0].coord, itemOpt[1].coord];\n      var target = {\n        coords: coords\n      };\n\n      if (itemOpt[0].name) {\n        target.fromName = itemOpt[0].name;\n      }\n\n      if (itemOpt[1].name) {\n        target.toName = itemOpt[1].name;\n      }\n\n      return mergeAll([target, itemOpt[0], itemOpt[1]]);\n    });\n  }\n}\n\nvar LinesSeries = SeriesModel.extend({\n  type: 'series.lines',\n  dependencies: ['grid', 'polar'],\n  visualColorAccessPath: 'lineStyle.color',\n  init: function (option) {\n    // The input data may be null/undefined.\n    option.data = option.data || []; // Not using preprocessor because mergeOption may not have series.type\n\n    compatEc2(option);\n\n    var result = this._processFlatCoordsArray(option.data);\n\n    this._flatCoords = result.flatCoords;\n    this._flatCoordsOffset = result.flatCoordsOffset;\n\n    if (result.flatCoords) {\n      option.data = new Float32Array(result.count);\n    }\n\n    LinesSeries.superApply(this, 'init', arguments);\n  },\n  mergeOption: function (option) {\n    compatEc2(option);\n\n    if (option.data) {\n      // Only update when have option data to merge.\n      var result = this._processFlatCoordsArray(option.data);\n\n      this._flatCoords = result.flatCoords;\n      this._flatCoordsOffset = result.flatCoordsOffset;\n\n      if (result.flatCoords) {\n        option.data = new Float32Array(result.count);\n      }\n    }\n\n    LinesSeries.superApply(this, 'mergeOption', arguments);\n  },\n  appendData: function (params) {\n    var result = this._processFlatCoordsArray(params.data);\n\n    if (result.flatCoords) {\n      if (!this._flatCoords) {\n        this._flatCoords = result.flatCoords;\n        this._flatCoordsOffset = result.flatCoordsOffset;\n      } else {\n        this._flatCoords = concatArray(this._flatCoords, result.flatCoords);\n        this._flatCoordsOffset = concatArray(this._flatCoordsOffset, result.flatCoordsOffset);\n      }\n\n      params.data = new Float32Array(result.count);\n    }\n\n    this.getRawData().appendData(params.data);\n  },\n  _getCoordsFromItemModel: function (idx) {\n    var itemModel = this.getData().getItemModel(idx);\n    var coords = itemModel.option instanceof Array ? itemModel.option : itemModel.getShallow('coords');\n    return coords;\n  },\n  getLineCoordsCount: function (idx) {\n    if (this._flatCoordsOffset) {\n      return this._flatCoordsOffset[idx * 2 + 1];\n    } else {\n      return this._getCoordsFromItemModel(idx).length;\n    }\n  },\n  getLineCoords: function (idx, out) {\n    if (this._flatCoordsOffset) {\n      var offset = this._flatCoordsOffset[idx * 2];\n      var len = this._flatCoordsOffset[idx * 2 + 1];\n\n      for (var i = 0; i < len; i++) {\n        out[i] = out[i] || [];\n        out[i][0] = this._flatCoords[offset + i * 2];\n        out[i][1] = this._flatCoords[offset + i * 2 + 1];\n      }\n\n      return len;\n    } else {\n      var coords = this._getCoordsFromItemModel(idx);\n\n      for (var i = 0; i < coords.length; i++) {\n        out[i] = out[i] || [];\n        out[i][0] = coords[i][0];\n        out[i][1] = coords[i][1];\n      }\n\n      return coords.length;\n    }\n  },\n  _processFlatCoordsArray: function (data) {\n    var startOffset = 0;\n\n    if (this._flatCoords) {\n      startOffset = this._flatCoords.length;\n    } // Stored as a typed array. In format\n    // Points Count(2) | x | y | x | y | Points Count(3) | x |  y | x | y | x | y |\n\n\n    if (typeof data[0] === 'number') {\n      var len = data.length; // Store offset and len of each segment\n\n      var coordsOffsetAndLenStorage = new Uint32Arr(len);\n      var coordsStorage = new Float64Arr(len);\n      var coordsCursor = 0;\n      var offsetCursor = 0;\n      var dataCount = 0;\n\n      for (var i = 0; i < len;) {\n        dataCount++;\n        var count = data[i++]; // Offset\n\n        coordsOffsetAndLenStorage[offsetCursor++] = coordsCursor + startOffset; // Len\n\n        coordsOffsetAndLenStorage[offsetCursor++] = count;\n\n        for (var k = 0; k < count; k++) {\n          var x = data[i++];\n          var y = data[i++];\n          coordsStorage[coordsCursor++] = x;\n          coordsStorage[coordsCursor++] = y;\n\n          if (i > len) {}\n        }\n      }\n\n      return {\n        flatCoordsOffset: new Uint32Array(coordsOffsetAndLenStorage.buffer, 0, offsetCursor),\n        flatCoords: coordsStorage,\n        count: dataCount\n      };\n    }\n\n    return {\n      flatCoordsOffset: null,\n      flatCoords: null,\n      count: data.length\n    };\n  },\n  getInitialData: function (option, ecModel) {\n    var lineData = new List(['value'], this);\n    lineData.hasItemOption = false;\n    lineData.initData(option.data, [], function (dataItem, dimName, dataIndex, dimIndex) {\n      // dataItem is simply coords\n      if (dataItem instanceof Array) {\n        return NaN;\n      } else {\n        lineData.hasItemOption = true;\n        var value = dataItem.value;\n\n        if (value != null) {\n          return value instanceof Array ? value[dimIndex] : value;\n        }\n      }\n    });\n    return lineData;\n  },\n  formatTooltip: function (dataIndex) {\n    var data = this.getData();\n    var itemModel = data.getItemModel(dataIndex);\n    var name = itemModel.get('name');\n\n    if (name) {\n      return name;\n    }\n\n    var fromName = itemModel.get('fromName');\n    var toName = itemModel.get('toName');\n    var html = [];\n    fromName != null && html.push(fromName);\n    toName != null && html.push(toName);\n    return encodeHTML(html.join(' > '));\n  },\n  preventIncremental: function () {\n    return !!this.get('effect.show');\n  },\n  getProgressive: function () {\n    var progressive = this.option.progressive;\n\n    if (progressive == null) {\n      return this.option.large ? 1e4 : this.get('progressive');\n    }\n\n    return progressive;\n  },\n  getProgressiveThreshold: function () {\n    var progressiveThreshold = this.option.progressiveThreshold;\n\n    if (progressiveThreshold == null) {\n      return this.option.large ? 2e4 : this.get('progressiveThreshold');\n    }\n\n    return progressiveThreshold;\n  },\n  defaultOption: {\n    coordinateSystem: 'geo',\n    zlevel: 0,\n    z: 2,\n    legendHoverLink: true,\n    hoverAnimation: true,\n    // Cartesian coordinate system\n    xAxisIndex: 0,\n    yAxisIndex: 0,\n    symbol: ['none', 'none'],\n    symbolSize: [10, 10],\n    // Geo coordinate system\n    geoIndex: 0,\n    effect: {\n      show: false,\n      period: 4,\n      // Animation delay. support callback\n      // delay: 0,\n      // If move with constant speed px/sec\n      // period will be ignored if this property is > 0,\n      constantSpeed: 0,\n      symbol: 'circle',\n      symbolSize: 3,\n      loop: true,\n      // Length of trail, 0 - 1\n      trailLength: 0.2 // Same with lineStyle.color\n      // color\n\n    },\n    large: false,\n    // Available when large is true\n    largeThreshold: 2000,\n    // If lines are polyline\n    // polyline not support curveness, label, animation\n    polyline: false,\n    // If clip the overflow.\n    // Available when coordinateSystem is cartesian or polar.\n    clip: true,\n    label: {\n      show: false,\n      position: 'end' // distance: 5,\n      // formatter: 标签文本格式器，同Tooltip.formatter，不支持异步回调\n\n    },\n    lineStyle: {\n      opacity: 0.5\n    }\n  }\n});\nvar _default = LinesSeries;\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}