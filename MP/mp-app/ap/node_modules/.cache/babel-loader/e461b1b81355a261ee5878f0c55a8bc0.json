{"ast":null,"code":"var logError = require(\"../core/log\");\n\nvar vmlCore = require(\"./core\");\n\nvar _util = require(\"../core/util\");\n\nvar each = _util.each;\n/**\n * VML Painter.\n *\n * @module zrender/vml/Painter\n */\n\nfunction parseInt10(val) {\n  return parseInt(val, 10);\n}\n/**\n * @alias module:zrender/vml/Painter\n */\n\n\nfunction VMLPainter(root, storage) {\n  vmlCore.initVML();\n  this.root = root;\n  this.storage = storage;\n  var vmlViewport = document.createElement('div');\n  var vmlRoot = document.createElement('div');\n  vmlViewport.style.cssText = 'display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;';\n  vmlRoot.style.cssText = 'position:absolute;left:0;top:0;';\n  root.appendChild(vmlViewport);\n  this._vmlRoot = vmlRoot;\n  this._vmlViewport = vmlViewport;\n  this.resize(); // Modify storage\n\n  var oldDelFromStorage = storage.delFromStorage;\n  var oldAddToStorage = storage.addToStorage;\n\n  storage.delFromStorage = function (el) {\n    oldDelFromStorage.call(storage, el);\n\n    if (el) {\n      el.onRemove && el.onRemove(vmlRoot);\n    }\n  };\n\n  storage.addToStorage = function (el) {\n    // Displayable already has a vml node\n    el.onAdd && el.onAdd(vmlRoot);\n    oldAddToStorage.call(storage, el);\n  };\n\n  this._firstPaint = true;\n}\n\nVMLPainter.prototype = {\n  constructor: VMLPainter,\n  getType: function getType() {\n    return 'vml';\n  },\n\n  /**\n   * @return {HTMLDivElement}\n   */\n  getViewportRoot: function getViewportRoot() {\n    return this._vmlViewport;\n  },\n  getViewportRootOffset: function getViewportRootOffset() {\n    var viewportRoot = this.getViewportRoot();\n\n    if (viewportRoot) {\n      return {\n        offsetLeft: viewportRoot.offsetLeft || 0,\n        offsetTop: viewportRoot.offsetTop || 0\n      };\n    }\n  },\n\n  /**\n   * 刷新\n   */\n  refresh: function refresh() {\n    var list = this.storage.getDisplayList(true, true);\n\n    this._paintList(list);\n  },\n  _paintList: function _paintList(list) {\n    var vmlRoot = this._vmlRoot;\n\n    for (var i = 0; i < list.length; i++) {\n      var el = list[i];\n\n      if (el.invisible || el.ignore) {\n        if (!el.__alreadyNotVisible) {\n          el.onRemove(vmlRoot);\n        } // Set as already invisible\n\n\n        el.__alreadyNotVisible = true;\n      } else {\n        if (el.__alreadyNotVisible) {\n          el.onAdd(vmlRoot);\n        }\n\n        el.__alreadyNotVisible = false;\n\n        if (el.__dirty) {\n          el.beforeBrush && el.beforeBrush();\n          (el.brushVML || el.brush).call(el, vmlRoot);\n          el.afterBrush && el.afterBrush();\n        }\n      }\n\n      el.__dirty = false;\n    }\n\n    if (this._firstPaint) {\n      // Detached from document at first time\n      // to avoid page refreshing too many times\n      // FIXME 如果每次都先 removeChild 可能会导致一些填充和描边的效果改变\n      this._vmlViewport.appendChild(vmlRoot);\n\n      this._firstPaint = false;\n    }\n  },\n  resize: function resize(width, height) {\n    var width = width == null ? this._getWidth() : width;\n    var height = height == null ? this._getHeight() : height;\n\n    if (this._width !== width || this._height !== height) {\n      this._width = width;\n      this._height = height;\n      var vmlViewportStyle = this._vmlViewport.style;\n      vmlViewportStyle.width = width + 'px';\n      vmlViewportStyle.height = height + 'px';\n    }\n  },\n  dispose: function dispose() {\n    this.root.innerHTML = '';\n    this._vmlRoot = this._vmlViewport = this.storage = null;\n  },\n  getWidth: function getWidth() {\n    return this._width;\n  },\n  getHeight: function getHeight() {\n    return this._height;\n  },\n  clear: function clear() {\n    if (this._vmlViewport) {\n      this.root.removeChild(this._vmlViewport);\n    }\n  },\n  _getWidth: function _getWidth() {\n    var root = this.root;\n    var stl = root.currentStyle;\n    return (root.clientWidth || parseInt10(stl.width)) - parseInt10(stl.paddingLeft) - parseInt10(stl.paddingRight) | 0;\n  },\n  _getHeight: function _getHeight() {\n    var root = this.root;\n    var stl = root.currentStyle;\n    return (root.clientHeight || parseInt10(stl.height)) - parseInt10(stl.paddingTop) - parseInt10(stl.paddingBottom) | 0;\n  }\n}; // Not supported methods\n\nfunction createMethodNotSupport(method) {\n  return function () {\n    logError('In IE8.0 VML mode painter not support method \"' + method + '\"');\n  };\n} // Unsupported methods\n\n\neach(['getLayer', 'insertLayer', 'eachLayer', 'eachBuiltinLayer', 'eachOtherLayer', 'getLayers', 'modLayer', 'delLayer', 'clearLayer', 'toDataURL', 'pathToImage'], function (name) {\n  VMLPainter.prototype[name] = createMethodNotSupport(name);\n});\nvar _default = VMLPainter;\nmodule.exports = _default;","map":{"version":3,"sources":["/home/johnatan/MP/mp-app/ap/node_modules/zrender/lib/vml/Painter.js"],"names":["logError","require","vmlCore","_util","each","parseInt10","val","parseInt","VMLPainter","root","storage","initVML","vmlViewport","document","createElement","vmlRoot","style","cssText","appendChild","_vmlRoot","_vmlViewport","resize","oldDelFromStorage","delFromStorage","oldAddToStorage","addToStorage","el","call","onRemove","onAdd","_firstPaint","prototype","constructor","getType","getViewportRoot","getViewportRootOffset","viewportRoot","offsetLeft","offsetTop","refresh","list","getDisplayList","_paintList","i","length","invisible","ignore","__alreadyNotVisible","__dirty","beforeBrush","brushVML","brush","afterBrush","width","height","_getWidth","_getHeight","_width","_height","vmlViewportStyle","dispose","innerHTML","getWidth","getHeight","clear","removeChild","stl","currentStyle","clientWidth","paddingLeft","paddingRight","clientHeight","paddingTop","paddingBottom","createMethodNotSupport","method","name","_default","module","exports"],"mappings":"AAAA,IAAIA,QAAQ,GAAGC,OAAO,CAAC,aAAD,CAAtB;;AAEA,IAAIC,OAAO,GAAGD,OAAO,CAAC,QAAD,CAArB;;AAEA,IAAIE,KAAK,GAAGF,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAIG,IAAI,GAAGD,KAAK,CAACC,IAAjB;AAEA;AACA;AACA;AACA;AACA;;AACA,SAASC,UAAT,CAAoBC,GAApB,EAAyB;AACvB,SAAOC,QAAQ,CAACD,GAAD,EAAM,EAAN,CAAf;AACD;AACD;AACA;AACA;;;AAGA,SAASE,UAAT,CAAoBC,IAApB,EAA0BC,OAA1B,EAAmC;AACjCR,EAAAA,OAAO,CAACS,OAAR;AACA,OAAKF,IAAL,GAAYA,IAAZ;AACA,OAAKC,OAAL,GAAeA,OAAf;AACA,MAAIE,WAAW,GAAGC,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAlB;AACA,MAAIC,OAAO,GAAGF,QAAQ,CAACC,aAAT,CAAuB,KAAvB,CAAd;AACAF,EAAAA,WAAW,CAACI,KAAZ,CAAkBC,OAAlB,GAA4B,kFAA5B;AACAF,EAAAA,OAAO,CAACC,KAAR,CAAcC,OAAd,GAAwB,iCAAxB;AACAR,EAAAA,IAAI,CAACS,WAAL,CAAiBN,WAAjB;AACA,OAAKO,QAAL,GAAgBJ,OAAhB;AACA,OAAKK,YAAL,GAAoBR,WAApB;AACA,OAAKS,MAAL,GAXiC,CAWlB;;AAEf,MAAIC,iBAAiB,GAAGZ,OAAO,CAACa,cAAhC;AACA,MAAIC,eAAe,GAAGd,OAAO,CAACe,YAA9B;;AAEAf,EAAAA,OAAO,CAACa,cAAR,GAAyB,UAAUG,EAAV,EAAc;AACrCJ,IAAAA,iBAAiB,CAACK,IAAlB,CAAuBjB,OAAvB,EAAgCgB,EAAhC;;AAEA,QAAIA,EAAJ,EAAQ;AACNA,MAAAA,EAAE,CAACE,QAAH,IAAeF,EAAE,CAACE,QAAH,CAAYb,OAAZ,CAAf;AACD;AACF,GAND;;AAQAL,EAAAA,OAAO,CAACe,YAAR,GAAuB,UAAUC,EAAV,EAAc;AACnC;AACAA,IAAAA,EAAE,CAACG,KAAH,IAAYH,EAAE,CAACG,KAAH,CAASd,OAAT,CAAZ;AACAS,IAAAA,eAAe,CAACG,IAAhB,CAAqBjB,OAArB,EAA8BgB,EAA9B;AACD,GAJD;;AAMA,OAAKI,WAAL,GAAmB,IAAnB;AACD;;AAEDtB,UAAU,CAACuB,SAAX,GAAuB;AACrBC,EAAAA,WAAW,EAAExB,UADQ;AAErByB,EAAAA,OAAO,EAAE,mBAAY;AACnB,WAAO,KAAP;AACD,GAJoB;;AAMrB;AACF;AACA;AACEC,EAAAA,eAAe,EAAE,2BAAY;AAC3B,WAAO,KAAKd,YAAZ;AACD,GAXoB;AAYrBe,EAAAA,qBAAqB,EAAE,iCAAY;AACjC,QAAIC,YAAY,GAAG,KAAKF,eAAL,EAAnB;;AAEA,QAAIE,YAAJ,EAAkB;AAChB,aAAO;AACLC,QAAAA,UAAU,EAAED,YAAY,CAACC,UAAb,IAA2B,CADlC;AAELC,QAAAA,SAAS,EAAEF,YAAY,CAACE,SAAb,IAA0B;AAFhC,OAAP;AAID;AACF,GArBoB;;AAuBrB;AACF;AACA;AACEC,EAAAA,OAAO,EAAE,mBAAY;AACnB,QAAIC,IAAI,GAAG,KAAK9B,OAAL,CAAa+B,cAAb,CAA4B,IAA5B,EAAkC,IAAlC,CAAX;;AAEA,SAAKC,UAAL,CAAgBF,IAAhB;AACD,GA9BoB;AA+BrBE,EAAAA,UAAU,EAAE,oBAAUF,IAAV,EAAgB;AAC1B,QAAIzB,OAAO,GAAG,KAAKI,QAAnB;;AAEA,SAAK,IAAIwB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,IAAI,CAACI,MAAzB,EAAiCD,CAAC,EAAlC,EAAsC;AACpC,UAAIjB,EAAE,GAAGc,IAAI,CAACG,CAAD,CAAb;;AAEA,UAAIjB,EAAE,CAACmB,SAAH,IAAgBnB,EAAE,CAACoB,MAAvB,EAA+B;AAC7B,YAAI,CAACpB,EAAE,CAACqB,mBAAR,EAA6B;AAC3BrB,UAAAA,EAAE,CAACE,QAAH,CAAYb,OAAZ;AACD,SAH4B,CAG3B;;;AAGFW,QAAAA,EAAE,CAACqB,mBAAH,GAAyB,IAAzB;AACD,OAPD,MAOO;AACL,YAAIrB,EAAE,CAACqB,mBAAP,EAA4B;AAC1BrB,UAAAA,EAAE,CAACG,KAAH,CAASd,OAAT;AACD;;AAEDW,QAAAA,EAAE,CAACqB,mBAAH,GAAyB,KAAzB;;AAEA,YAAIrB,EAAE,CAACsB,OAAP,EAAgB;AACdtB,UAAAA,EAAE,CAACuB,WAAH,IAAkBvB,EAAE,CAACuB,WAAH,EAAlB;AACA,WAACvB,EAAE,CAACwB,QAAH,IAAexB,EAAE,CAACyB,KAAnB,EAA0BxB,IAA1B,CAA+BD,EAA/B,EAAmCX,OAAnC;AACAW,UAAAA,EAAE,CAAC0B,UAAH,IAAiB1B,EAAE,CAAC0B,UAAH,EAAjB;AACD;AACF;;AAED1B,MAAAA,EAAE,CAACsB,OAAH,GAAa,KAAb;AACD;;AAED,QAAI,KAAKlB,WAAT,EAAsB;AACpB;AACA;AACA;AACA,WAAKV,YAAL,CAAkBF,WAAlB,CAA8BH,OAA9B;;AAEA,WAAKe,WAAL,GAAmB,KAAnB;AACD;AACF,GArEoB;AAsErBT,EAAAA,MAAM,EAAE,gBAAUgC,KAAV,EAAiBC,MAAjB,EAAyB;AAC/B,QAAID,KAAK,GAAGA,KAAK,IAAI,IAAT,GAAgB,KAAKE,SAAL,EAAhB,GAAmCF,KAA/C;AACA,QAAIC,MAAM,GAAGA,MAAM,IAAI,IAAV,GAAiB,KAAKE,UAAL,EAAjB,GAAqCF,MAAlD;;AAEA,QAAI,KAAKG,MAAL,KAAgBJ,KAAhB,IAAyB,KAAKK,OAAL,KAAiBJ,MAA9C,EAAsD;AACpD,WAAKG,MAAL,GAAcJ,KAAd;AACA,WAAKK,OAAL,GAAeJ,MAAf;AACA,UAAIK,gBAAgB,GAAG,KAAKvC,YAAL,CAAkBJ,KAAzC;AACA2C,MAAAA,gBAAgB,CAACN,KAAjB,GAAyBA,KAAK,GAAG,IAAjC;AACAM,MAAAA,gBAAgB,CAACL,MAAjB,GAA0BA,MAAM,GAAG,IAAnC;AACD;AACF,GAjFoB;AAkFrBM,EAAAA,OAAO,EAAE,mBAAY;AACnB,SAAKnD,IAAL,CAAUoD,SAAV,GAAsB,EAAtB;AACA,SAAK1C,QAAL,GAAgB,KAAKC,YAAL,GAAoB,KAAKV,OAAL,GAAe,IAAnD;AACD,GArFoB;AAsFrBoD,EAAAA,QAAQ,EAAE,oBAAY;AACpB,WAAO,KAAKL,MAAZ;AACD,GAxFoB;AAyFrBM,EAAAA,SAAS,EAAE,qBAAY;AACrB,WAAO,KAAKL,OAAZ;AACD,GA3FoB;AA4FrBM,EAAAA,KAAK,EAAE,iBAAY;AACjB,QAAI,KAAK5C,YAAT,EAAuB;AACrB,WAAKX,IAAL,CAAUwD,WAAV,CAAsB,KAAK7C,YAA3B;AACD;AACF,GAhGoB;AAiGrBmC,EAAAA,SAAS,EAAE,qBAAY;AACrB,QAAI9C,IAAI,GAAG,KAAKA,IAAhB;AACA,QAAIyD,GAAG,GAAGzD,IAAI,CAAC0D,YAAf;AACA,WAAO,CAAC1D,IAAI,CAAC2D,WAAL,IAAoB/D,UAAU,CAAC6D,GAAG,CAACb,KAAL,CAA/B,IAA8ChD,UAAU,CAAC6D,GAAG,CAACG,WAAL,CAAxD,GAA4EhE,UAAU,CAAC6D,GAAG,CAACI,YAAL,CAAtF,GAA2G,CAAlH;AACD,GArGoB;AAsGrBd,EAAAA,UAAU,EAAE,sBAAY;AACtB,QAAI/C,IAAI,GAAG,KAAKA,IAAhB;AACA,QAAIyD,GAAG,GAAGzD,IAAI,CAAC0D,YAAf;AACA,WAAO,CAAC1D,IAAI,CAAC8D,YAAL,IAAqBlE,UAAU,CAAC6D,GAAG,CAACZ,MAAL,CAAhC,IAAgDjD,UAAU,CAAC6D,GAAG,CAACM,UAAL,CAA1D,GAA6EnE,UAAU,CAAC6D,GAAG,CAACO,aAAL,CAAvF,GAA6G,CAApH;AACD;AA1GoB,CAAvB,C,CA2GG;;AAEH,SAASC,sBAAT,CAAgCC,MAAhC,EAAwC;AACtC,SAAO,YAAY;AACjB3E,IAAAA,QAAQ,CAAC,mDAAmD2E,MAAnD,GAA4D,GAA7D,CAAR;AACD,GAFD;AAGD,C,CAAC;;;AAGFvE,IAAI,CAAC,CAAC,UAAD,EAAa,aAAb,EAA4B,WAA5B,EAAyC,kBAAzC,EAA6D,gBAA7D,EAA+E,WAA/E,EAA4F,UAA5F,EAAwG,UAAxG,EAAoH,YAApH,EAAkI,WAAlI,EAA+I,aAA/I,CAAD,EAAgK,UAAUwE,IAAV,EAAgB;AAClLpE,EAAAA,UAAU,CAACuB,SAAX,CAAqB6C,IAArB,IAA6BF,sBAAsB,CAACE,IAAD,CAAnD;AACD,CAFG,CAAJ;AAGA,IAAIC,QAAQ,GAAGrE,UAAf;AACAsE,MAAM,CAACC,OAAP,GAAiBF,QAAjB","sourcesContent":["var logError = require(\"../core/log\");\n\nvar vmlCore = require(\"./core\");\n\nvar _util = require(\"../core/util\");\n\nvar each = _util.each;\n\n/**\n * VML Painter.\n *\n * @module zrender/vml/Painter\n */\nfunction parseInt10(val) {\n  return parseInt(val, 10);\n}\n/**\n * @alias module:zrender/vml/Painter\n */\n\n\nfunction VMLPainter(root, storage) {\n  vmlCore.initVML();\n  this.root = root;\n  this.storage = storage;\n  var vmlViewport = document.createElement('div');\n  var vmlRoot = document.createElement('div');\n  vmlViewport.style.cssText = 'display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;';\n  vmlRoot.style.cssText = 'position:absolute;left:0;top:0;';\n  root.appendChild(vmlViewport);\n  this._vmlRoot = vmlRoot;\n  this._vmlViewport = vmlViewport;\n  this.resize(); // Modify storage\n\n  var oldDelFromStorage = storage.delFromStorage;\n  var oldAddToStorage = storage.addToStorage;\n\n  storage.delFromStorage = function (el) {\n    oldDelFromStorage.call(storage, el);\n\n    if (el) {\n      el.onRemove && el.onRemove(vmlRoot);\n    }\n  };\n\n  storage.addToStorage = function (el) {\n    // Displayable already has a vml node\n    el.onAdd && el.onAdd(vmlRoot);\n    oldAddToStorage.call(storage, el);\n  };\n\n  this._firstPaint = true;\n}\n\nVMLPainter.prototype = {\n  constructor: VMLPainter,\n  getType: function () {\n    return 'vml';\n  },\n\n  /**\n   * @return {HTMLDivElement}\n   */\n  getViewportRoot: function () {\n    return this._vmlViewport;\n  },\n  getViewportRootOffset: function () {\n    var viewportRoot = this.getViewportRoot();\n\n    if (viewportRoot) {\n      return {\n        offsetLeft: viewportRoot.offsetLeft || 0,\n        offsetTop: viewportRoot.offsetTop || 0\n      };\n    }\n  },\n\n  /**\n   * 刷新\n   */\n  refresh: function () {\n    var list = this.storage.getDisplayList(true, true);\n\n    this._paintList(list);\n  },\n  _paintList: function (list) {\n    var vmlRoot = this._vmlRoot;\n\n    for (var i = 0; i < list.length; i++) {\n      var el = list[i];\n\n      if (el.invisible || el.ignore) {\n        if (!el.__alreadyNotVisible) {\n          el.onRemove(vmlRoot);\n        } // Set as already invisible\n\n\n        el.__alreadyNotVisible = true;\n      } else {\n        if (el.__alreadyNotVisible) {\n          el.onAdd(vmlRoot);\n        }\n\n        el.__alreadyNotVisible = false;\n\n        if (el.__dirty) {\n          el.beforeBrush && el.beforeBrush();\n          (el.brushVML || el.brush).call(el, vmlRoot);\n          el.afterBrush && el.afterBrush();\n        }\n      }\n\n      el.__dirty = false;\n    }\n\n    if (this._firstPaint) {\n      // Detached from document at first time\n      // to avoid page refreshing too many times\n      // FIXME 如果每次都先 removeChild 可能会导致一些填充和描边的效果改变\n      this._vmlViewport.appendChild(vmlRoot);\n\n      this._firstPaint = false;\n    }\n  },\n  resize: function (width, height) {\n    var width = width == null ? this._getWidth() : width;\n    var height = height == null ? this._getHeight() : height;\n\n    if (this._width !== width || this._height !== height) {\n      this._width = width;\n      this._height = height;\n      var vmlViewportStyle = this._vmlViewport.style;\n      vmlViewportStyle.width = width + 'px';\n      vmlViewportStyle.height = height + 'px';\n    }\n  },\n  dispose: function () {\n    this.root.innerHTML = '';\n    this._vmlRoot = this._vmlViewport = this.storage = null;\n  },\n  getWidth: function () {\n    return this._width;\n  },\n  getHeight: function () {\n    return this._height;\n  },\n  clear: function () {\n    if (this._vmlViewport) {\n      this.root.removeChild(this._vmlViewport);\n    }\n  },\n  _getWidth: function () {\n    var root = this.root;\n    var stl = root.currentStyle;\n    return (root.clientWidth || parseInt10(stl.width)) - parseInt10(stl.paddingLeft) - parseInt10(stl.paddingRight) | 0;\n  },\n  _getHeight: function () {\n    var root = this.root;\n    var stl = root.currentStyle;\n    return (root.clientHeight || parseInt10(stl.height)) - parseInt10(stl.paddingTop) - parseInt10(stl.paddingBottom) | 0;\n  }\n}; // Not supported methods\n\nfunction createMethodNotSupport(method) {\n  return function () {\n    logError('In IE8.0 VML mode painter not support method \"' + method + '\"');\n  };\n} // Unsupported methods\n\n\neach(['getLayer', 'insertLayer', 'eachLayer', 'eachBuiltinLayer', 'eachOtherLayer', 'getLayers', 'modLayer', 'delLayer', 'clearLayer', 'toDataURL', 'pathToImage'], function (name) {\n  VMLPainter.prototype[name] = createMethodNotSupport(name);\n});\nvar _default = VMLPainter;\nmodule.exports = _default;"]},"metadata":{},"sourceType":"script"}